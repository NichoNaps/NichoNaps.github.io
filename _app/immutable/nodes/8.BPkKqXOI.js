import{a as _,t as k,c as Re}from"../chunks/BCe9DMxx.js";import{aH as xe,aI as Ae,aJ as Ce,o as Oe,x as ae,G as Be,P as Ue,q as Ve,y as We,aa as Ge,aE as Te,au as He,R as ye,g as Je,p as me,c,r as v,t as C,a as _e,f as fe,ac as T,s as m,i as e,aK as Ke,aL as Xe,l as D,a8 as h}from"../chunks/Cwxz4zsB.js";import{l as Se,s as J,d as Ze,e as Qe,a as Ye}from"../chunks/D0_HKjy9.js";import{e as $e,i as ea}from"../chunks/BOdTrU8H.js";import{s as K,r as ue}from"../chunks/C9H9V2QD.js";import{i as aa,p as U}from"../chunks/BAXBLNLT.js";import{p as O,i as V}from"../chunks/D_0EBigx.js";import{t as ta}from"../chunks/Bvena8yX.js";import{r as ra}from"../chunks/CGLGJUg4.js";import{a as sa}from"../chunks/BHrwyQfe.js";import{s as ia}from"../chunks/D9c0H0XM.js";function la(t,a,r){ae&&Be();var o=t,l=Ge,s,i=xe()?Ae:Ce;Oe(()=>{i(l,l=a())&&(s&&Ue(s),s=Ve(()=>r(o)))}),ae&&(o=We)}function ne(t,a,r=a){var o=xe();Se(t,"input",l=>{var s=l?t.defaultValue:t.value;if(s=ce(t)?de(s):s,r(s),o&&s!==(s=a())){var i=t.selectionStart,f=t.selectionEnd;t.value=s??"",f!==null&&(t.selectionStart=i,t.selectionEnd=Math.min(f,t.value.length))}}),(ae&&t.defaultValue!==t.value||Je(a)==null&&t.value)&&r(ce(t)?de(t.value):t.value),Te(()=>{var l=a();ce(t)&&l===de(t.value)||t.type==="date"&&!l&&!t.value||l!==t.value&&(t.value=l??"")})}const ve=new Set;function oa(t,a,r,o,l=o){var s=r.getAttribute("type")==="checkbox",i=t;let f=!1;if(a!==null)for(var g of a)i=i[g]??(i[g]=[]);i.push(r),Se(r,"change",()=>{var n=r.__value;s&&(n=je(i,n,r.checked)),l(n)},()=>l(s?[]:null)),Te(()=>{var n=o();if(ae&&r.defaultChecked!==r.checked){f=!0;return}s?(n=n||[],r.checked=n.includes(r.__value)):r.checked=aa(r.__value,n)}),He(()=>{var n=i.indexOf(r);n!==-1&&i.splice(n,1)}),ve.has(i)||(ve.add(i),ye(()=>{i.sort((n,b)=>n.compareDocumentPosition(b)===4?-1:1),ve.delete(i)})),ye(()=>{if(f){var n;if(s)n=je(i,n,r.checked);else{var b=i.find(u=>u.checked);n=b==null?void 0:b.__value}l(n)}})}function je(t,a,r){for(var o=new Set,l=0;l<t.length;l+=1)t[l].checked&&o.add(t[l].__value);return r||o.delete(a),Array.from(o)}function ce(t){var a=t.type;return a==="number"||a==="range"}function de(t){return t===""?null:+t}var na=k('<div style="aspect-ratio: 1/1; display: inline-block;"><div class="backing svelte-efxvsm"><div><!></div></div></div>');function va(t,a){me(a,!0);let r=O(a,"borderRadius",3,"10px"),o=O(a,"progress",7,0),l=O(a,"color",3,"rgb(153, 86, 86)"),s=O(a,"extraPadding",3,"18px");o(Math.max(1,o()));var i=na(),f=c(i),g=c(f),n=c(g);{var b=u=>{var p=Re(),F=fe(p);ia(F,()=>a.children),_(u,p)};V(n,u=>{a.children&&u(b)})}v(g),v(f),v(i),C(()=>K(f,"style",`--ring-width: ${r()??""}; --progress: ${o()??""}%; --ring-color: ${l()??""}; --extra-padding: ${s()??""};`)),_(t,i),_e()}var ca=k('<span class="point-view svelte-15t8e2c"> </span>');function Ee(t,a){var r=ca(),o=c(r);v(r),C(()=>J(o,`ðŸª™ ${a.amount??""}`)),_(t,r)}var da=k('<textarea id="timer-name-edit" class="svelte-1ihjghp"></textarea>'),ha=k('<span style="font-style: italic; color: #bbbE;" class="svelte-1ihjghp"> </span>'),fa=k('<div class="svelte-1ihjghp"><div class="center-hz svelte-1ihjghp" style="color: #bbbE;"> </div> <h1 class="timer-text center-hz svelte-1ihjghp"> </h1> <div class="timer-task center-vt svelte-1ihjghp"><div class="center-hz svelte-1ihjghp"><!></div></div></div>'),ua=(t,a)=>a(!0),ma=k('<button class="btn btn-secondary svelte-1ihjghp" aria-label="finish current task"><i class="bi bi-check-circle svelte-1ihjghp"></i></button>'),_a=k('<button class="btn btn-danger svelte-1ihjghp" aria-label="resume"><i class="bi bi-play-fill svelte-1ihjghp"></i></button>'),ga=k('<button class="btn btn-secondary svelte-1ihjghp" aria-label="pause"><i class="bi bi-pause-fill svelte-1ihjghp"></i></button>'),ba=k('<div class="appear svelte-1ihjghp"><!> <div class="timer-btns center-hz appear mt-3 svelte-1ihjghp"><button class="btn btn-secondary svelte-1ihjghp">Cash Out <!></button> <!> <!></div></div>'),ka=k('<div class="form-group svelte-1ihjghp"><label class="svelte-1ihjghp">What would you like to work on? <input class="form-control svelte-1ihjghp" placeholder="Set task name"></label></div>'),pa=k('<div class="center-vt svelte-1ihjghp"><div class="form-group svelte-1ihjghp"><label class="svelte-1ihjghp">Duration: <input class="form-control svelte-1ihjghp" type="number" min="1" max="50"></label></div> <!> <button class="btn btn-primary mt-4 svelte-1ihjghp">Start</button></div>'),wa=k('<div class="center-hz svelte-1ihjghp"><div class="center-vt svelte-1ihjghp"><div class="center-hz svelte-1ihjghp"></div> <div class="center-hz svelte-1ihjghp"><!></div></div></div>');function ya(t,a){me(a,!0);let r=O(a,"taskName",15,void 0),o=O(a,"onFinish",3,void 0),l=O(a,"onTaskFinish",3,void 0),s=T(!1),i=T(!1),f=T(U(a.mode.length)),g=D(()=>e(f)*60),n=T(U(new Date)),b=T(void 0),u=T(0),p=T(0),F=D(()=>e(u)+e(p)),B=D(()=>Math.max(0,e(g)-e(F))),S=D(()=>Math.floor(e(B)/60)%60),E=D(()=>Math.round(e(B))%60),I=D(()=>new Date(e(n).getTime()+(e(g)-e(p))*1e3)),X=D(()=>Math.round(e(F)/e(g)*100)),P=[10,5,2,1];function N(){let d=(new Date-e(n))/1e3;if(d>e(g))h(u,U(e(g))),G(!0),W("Pomodoro","Out of time"),alert("Ran out of time to cash out.");else{for(h(u,d);P[0]>=e(f);)P=P.slice(1);e(B)<P[0]*60&&(W("Pomodoro",`${(e(B)/60).toFixed(2)} minutes remaining.`),P=P.slice(1))}}function W(d,y,j="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let q={body:y,img:""};j!=null&&(q.tag=j),new Notification(d,q)}}function z(){Notification.requestPermission().then(d=>{}),h(s,!0),h(i,!1),e(u)!=0&&(h(p,e(p)+e(u)),h(u,0)),h(n,U(new Date)),N(),h(b,U(setInterval(N,1e3)))}function G(d=!1){o()(e(F)/60,d),h(s,!1),h(i,!1),clearInterval(e(b)),h(u,0),h(p,0)}function Z(){h(i,!0),clearInterval(e(b))}sa(()=>{e(s)&&G(!1)});function ge(){l()(r()),document.getElementById("timer-name-edit").select()}var te=wa();Qe("keydown",Ke,d=>{d.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),e(s)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&(d.key==" "?(e(i)?z():Z(),d.preventDefault()):d.key=="f"&&r()!=null&&confirm("Finish task: "+r())&&(ge(),d.preventDefault()))}),Ye(d=>{C((y,j)=>Xe.title=`${y??""}:${j??""} - Pomodoro`,[()=>e(S).toString().padStart(2,"0"),()=>e(E).toString().padStart(2,"0")])});var be=c(te),ke=m(c(be),2),Ie=c(ke);{var Pe=d=>{var y=ba(),j=c(y);va(j,{get progress(){return e(X)},get color(){return a.mode.color},children:(w,M)=>{var ie=fa(),le=c(ie),De=c(le,!0);v(le);var ee=m(le,2),Fe=c(ee);v(ee);var pe=m(ee,2),we=c(pe),ze=c(we);{var qe=R=>{var x=da();ra(x),C(()=>K(x,"placeholder",a.mode.name)),ne(x,r),_(R,x)},Le=R=>{var x=ha(),oe=c(x,!0);v(x),C(()=>J(oe,a.mode.name)),_(R,x)};V(ze,R=>{a.mode.hasTask?R(qe):R(Le,!1)})}v(we),v(pe),v(ie),C((R,x,oe)=>{J(De,R),ta(ee,"paused",e(i)),J(Fe,`${x??""}:${oe??""}`)},[()=>e(I).toLocaleTimeString(),()=>e(S).toString().padStart(2,"0"),()=>e(E).toString().padStart(2,"0")]),_(w,ie)},$$slots:{default:!0}});var q=m(j,2),A=c(q);A.__click=[ua,G];var Q=m(c(A));const re=D(()=>a.mode.calcScore(e(F)/60));var se=D(()=>e(re));Ee(Q,{get amount(){return e(se)}}),v(A);var L=m(A,2);{var H=w=>{var M=ma();M.__click=ge,_(w,M)};V(L,w=>{a.mode.hasTask&&w(H)})}var Y=m(L,2);{var $=w=>{var M=_a();M.__click=z,_(w,M)},Me=w=>{var M=ga();M.__click=Z,_(w,M)};V(Y,w=>{e(i)?w($):w(Me,!1)})}v(q),v(y),_(d,y)},Ne=d=>{var y=pa(),j=c(y),q=c(j),A=m(c(q));ue(A),v(q),v(j);var Q=m(j,2);{var re=L=>{var H=ka(),Y=c(H),$=m(c(Y));ue($),v(Y),v(H),ne($,r),_(L,H)};V(Q,L=>{a.mode.hasTask&&L(re)})}var se=m(Q,2);se.__click=z,v(y),ne(A,()=>e(f),L=>h(f,L)),_(d,y)};V(Ie,d=>{e(s)?d(Pe):d(Ne,!1)})}v(ke),v(be),v(te),_(t,te),_e()}Ze(["click"]);class he{constructor({name:a,length:r,color:o,reward:l,hasTask:s=!1}){this.name=a,this.length=r,this.color=o,this.reward=l,this.hasTask=s}calcScore(a){let r=10;return a<1?0:Math.round(1/(1+Math.pow(Math.E,-((a-this.length/2)*(r/this.length))))*this.reward)}}var ja=k('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-12sfgq9"> </label>',1),xa=k('<br> <br>  <div class="center-hz mb-3 svelte-12sfgq9"><div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> <!></div> <!>',1);function La(t,a){me(a,!0);const r=[],o={work:new he({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new he({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new he({name:"Long Break",length:10,color:"#237047",reward:450})};let l=T(""),s=T("work"),i=0,f=T(0);function g(S,E){h(f,e(f)+o[e(s)].calcScore(S)),E&&(e(s)=="work"?(i+=S,i>=o.work.length*3.4?(i=0,h(s,"longbreak")):h(s,"break")):h(s,"work"))}function n(){h(f,e(f)+1e3)}var b=xa(),u=m(fe(b),4),p=c(u);$e(p,21,()=>Object.entries(o),ea,(S,E)=>{let I=()=>e(E)[0],X=()=>e(E)[1];var P=ja(),N=fe(P);ue(N);var W,z=m(N,2),G=c(z,!0);v(z),C(()=>{K(N,"id",`radio-${I()}`),W!==(W=I())&&(N.value=(N.__value=I())==null?"":I()),K(z,"for",`radio-${I()}`),K(z,"style",e(s)==I()?`background-color: ${X().color};`:""),J(G,X().name)}),oa(r,[],N,()=>(I(),e(s)),Z=>h(s,Z)),_(S,P)}),v(p);var F=m(p,2);Ee(F,{get amount(){return e(f)}}),v(u);var B=m(u,2);la(B,()=>e(s),S=>{ya(S,{get mode(){return o[e(s)]},onFinish:g,onTaskFinish:n,get taskName(){return e(l)},set taskName(E){h(l,U(E))}})}),_(t,b),_e()}export{La as component};
