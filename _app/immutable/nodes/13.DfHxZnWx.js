import{a as m,t as y,c as ut}from"../chunks/u3dcRfK7.js";import{v as Bt,aK as Ct,ak as Ot,y as Ut,w as kt,K as Rt,R as Vt,z as $t,C as jt,af as Jt,p as at,c as l,r as s,t as W,a as nt,f as et,aj as A,h as Dt,s as w,g as t,ad as g,aL as gt,$ as Kt,m as O,aJ as yt,n as Gt}from"../chunks/DzHGrAB7.js";import{s as dt,d as Tt,e as wt}from"../chunks/hVlh8FA6.js";import{e as It,i as xt}from"../chunks/Ch4bqiDD.js";import{s as j,r as mt}from"../chunks/BW97vLB3.js";import{a as Mt,b as Wt,c as Ht}from"../chunks/Ctp1LBSw.js";import{p as F}from"../chunks/CYEbeHLi.js";import{p as R,i as H,a as Ft,b as ct,c as V,d as St}from"../chunks/CbRT5sQE.js";import{h as Qt}from"../chunks/D6Xn1kCk.js";import{t as st}from"../chunks/Cqanicu_.js";import{a as Xt}from"../chunks/-tluWSQ4.js";import{s as Pt}from"../chunks/pE0dASaU.js";import{w as Zt}from"../chunks/CA1u_qlU.js";function Lt(c,e,n){kt&&Rt();var o=c,a=Jt,i,f=Bt()?Ct:Ot;Ut(()=>{f(a,a=e())&&(i&&Vt(i),i=$t(()=>n(o)))}),kt&&(o=jt)}var Yt=y('<div><div class="backing svelte-efxvsm"><div><!></div></div></div>');function te(c,e){at(e,!0);let n=R(e,"borderRadius",3,"10px"),o=R(e,"progress",7,0),a=R(e,"color",3,"rgb(153, 86, 86)"),i=R(e,"extraPadding",3,"18px"),f=R(e,"style",3,"");o(Math.max(1,o()));var v=Yt(),k=l(v),T=l(k),u=l(T);{var _=S=>{var h=ut(),N=et(h);Pt(N,()=>e.children),m(S,h)};H(u,S=>{e.children&&S(_)})}s(T),s(k),s(v),W(()=>{j(v,"style",`aspect-ratio: 1/1; display: inline-block; ${f()??""}`),j(k,"style",`--ring-width: ${n()??""}; --progress: ${o()??""}%; --ring-color: ${a()??""}; --extra-padding: ${i()??""};`)}),m(c,v),nt()}var ee=y('<span class="points-change svelte-muo1s8"> </span>'),ae=y('<span class="point-view svelte-muo1s8"><!> <span class="points svelte-muo1s8"> </span></span>');function Et(c,e){at(e,!0);let n=R(e,"formatter",7,null),o=e.amount==null,a=A(0),i=A(F(e.amount));Dt(()=>{n().format(0)!=n().format(Math.abs(e.amount-t(i)))&&(g(a,e.amount-t(i)),g(i,F(e.amount)))}),n(n()==null?new Intl.NumberFormat("en-US"):n());var f=ae(),v=l(f);Lt(v,()=>t(a),u=>{var _=ut(),S=et(_);{var h=N=>{var E=ee(),z=l(E);s(E),W(J=>{j(E,"style",`color: ${(t(a)>=0?"#0F0":"#F00")??""};`),dt(z,`${(t(a)>0?"+":"-")??""}${J??""}`)},[()=>n().format(Math.abs(t(a)))]),m(N,E)};H(S,N=>{t(a)!=0&&N(h)})}m(u,_)});var k=w(v,2),T=l(k,!0);s(k),s(f),W(u=>{st(f,"hide-first",o),st(f,"hide-first-reveal",e.amount!=null&&o),dt(T,u)},[()=>n().format(e.amount)]),m(c,f),nt()}var ne=y('<span class="svelte-gdak9n">ðŸª™ <!></span>');function Nt(c,e){var n=ne(),o=w(l(n));Et(o,{get amount(){return e.amount}}),s(n),m(c,n)}var oe=(c,e)=>confirm("Quit timer without cashing out?")?e(!0,!1):null,re=y('<button class="btn btn-danger svelte-pmthtr" aria-label="resume"><i class="bi bi-play-fill svelte-pmthtr"></i></button>'),se=y('<button class="btn btn-outline svelte-pmthtr" aria-label="pause"><i class="bi bi-pause-fill svelte-pmthtr"></i></button>'),ie=y('<div class="center-hz svelte-pmthtr"><button class="btn btn-outline svelte-pmthtr" aria-label="quit timer without cashing out points"><i class="bi bi-x-circle svelte-pmthtr"></i></button> <!></div>'),le=y('<div class="center-hz svelte-pmthtr"><input class="form-control svelte-pmthtr" type="number" style="width: 50%;" min="1" max="50"></div>'),ce=y('<div class="svelte-pmthtr"><div class="timer-subtext center-hz svelte-pmthtr"> </div> <div class="timer-text center-hz svelte-pmthtr"> </div> <!></div>'),ve=(c,e)=>e(!1,!0),de=y('<button id="cashout-btn" class="btn btn-secondary btn-lg svelte-pmthtr">Cash Out <!></button>'),ue=y('<button class="btn btn-primary btn-lg svelte-pmthtr">Start</button>'),me=y('<div class="center-hz svelte-pmthtr"><div class="center-vt svelte-pmthtr" style="width: 100%;"><div class="appear svelte-pmthtr"><!> <div class="center-hz mt-4 svelte-pmthtr"><!></div></div></div></div>');function fe(c,e){at(e,!0);let n=R(e,"onFinish",3,void 0),o=R(e,"onStart",3,void 0),a=A(!1),i=A(!1),f=A(F(e.mode.length)),v=O(()=>t(f)*60),k=A(F(new Date)),T=A(void 0),u=A(0),_=A(0),S=O(()=>t(u)+t(_)),h=O(()=>t(v)-t(S)),N=O(()=>Math.floor(Math.abs(t(h))/60)%60),E=O(()=>Math.round(Math.abs(t(h)))%60),z=O(()=>`${t(N).toString().padStart(2,"0")}:${t(E).toString().padStart(2,"0")}`),J=O(()=>new Date(t(k).getTime()+(t(v)-t(_))*1e3)),Q=O(()=>Math.min(100,Math.round(t(S)/t(v)*100))),r=[10,5,2,1,0];for(;r[0]>=e.mode.length;)r=r.slice(1);function b(d,p,L="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let C={body:p,img:""};L!=null&&(C.tag=L),new Notification(d,C)}}function M(){g(u,(new Date-t(k))/1e3),t(h)<r[0]*60?(t(h)<0&&r[0]==0?b("Pomodoro","Finished. Good job!"):b("Pomodoro",`${r[0]} minutes remaining.`),r=r.slice(1)):t(h)<0&&r.length==0&&Math.abs(Math.abs(t(h))%60-30)<.6&&b("Pomodoro",`Overtime by ${(Math.abs(t(v)+t(h))/60).toFixed(1)} minutes.`)}function D(){o()&&o()(),Notification.requestPermission().then(d=>{}),g(a,!0),g(i,!1),t(u)!=0&&(g(_,t(_)+t(u)),g(u,0)),g(k,F(new Date)),M(),g(T,F(setInterval(M,1e3)))}function I(d=!1,p=!1){let L=t(S)/60;n()(L,d?0:e.mode.calcScore(L,t(f)),p),g(a,!1),g(i,!1),clearInterval(t(T)),g(u,0),g(_,0)}function $(){g(i,!0),clearInterval(t(T))}Xt(()=>{t(a)&&I(!1,!1)});var q=me();wt("keydown",gt,d=>{d.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),t(a)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&d.key==" "&&(t(i)?D():$(),d.preventDefault())}),wt("beforeunload",gt,d=>{t(a)&&(d.preventDefault(),d.returnValue=!0)}),Qt(d=>{W(()=>Kt.title=`${(t(a)?`${t(z)} - `:"")??""}Pomodoro`)});var X=l(q),Z=l(X),B=l(Z);te(B,{get progress(){return t(Q)},get color(){return e.mode.color},style:"width: 100%;",children:(d,p)=>{var L=ce(),C=l(L),U=l(C,!0);s(C);var Y=w(C,2),ot=l(Y,!0);s(Y);var ht=w(Y,2);{var bt=G=>{var tt=ie(),it=l(tt);it.__click=[oe,I];var _t=w(it,2);{var At=rt=>{var lt=re();lt.__click=D,m(rt,lt)},qt=rt=>{var lt=se();lt.__click=$,m(rt,lt)};H(_t,rt=>{t(i)?rt(At):rt(qt,!1)})}s(tt),m(G,tt)},zt=G=>{var tt=le(),it=l(tt);mt(it),s(tt),Mt(it,()=>t(f),_t=>g(f,_t)),m(G,tt)};H(ht,G=>{t(a)?G(bt):G(zt,!1)})}s(L),W(G=>{dt(U,G),st(Y,"paused",t(i)),dt(ot,t(z))},[()=>t(J).toLocaleTimeString()]),m(d,L)},$$slots:{default:!0}});var x=w(B,2),K=l(x);{var ft=d=>{var p=de();p.__click=[ve,I];var L=w(l(p));const C=O(()=>e.mode.calcScore(t(S)/60,t(f)));var U=O(()=>t(C));Nt(L,{get amount(){return t(U)}}),s(p),m(d,p)},P=d=>{var p=ue();p.__click=D,m(d,p)};H(K,d=>{t(a)?d(ft):d(P,!1)})}s(x),s(Z),s(X),s(q),W(()=>{st(q,"overDone",t(h)<0),st(q,"almostDone",t(h)<60)}),m(c,q),nt()}Tt(["click"]);class pt{constructor({name:e,length:n,color:o,reward:a,hasTask:i=!1}){this.name=e,this.length=n,this.color=o,this.reward=a,this.hasTask=i}calcScore(e,n){let o=5;if(e<.5)return 0;let a=e>n?Math.min(1,n/this.length):e<this.length?e/this.length:1,i=e>n?Math.pow((e-n)/o,2):0;return Math.max(0,Math.round((a-i)*this.reward))}}function vt(c,e,n=null){{let a=localStorage.getItem(c);a!==null&&(e=JSON.parse(a))}const o=Zt(e);return o.subscribe(a=>{console.log("WRITING",a),localStorage.setItem(c,JSON.stringify(a))}),o}var he=y('<div class="body svelte-mgslqn"><!></div>');function be(c,e){at(e,!0);let n=R(e,"visible",15,!0),o=O(()=>n()?Date.now():null);var a=ut();wt("click",gt,v=>{n()&&Date.now()-t(o)>200&&n(!1)});var i=et(a);{var f=v=>{var k=he(),T=l(k);{var u=_=>{var S=ut(),h=et(S);Pt(h,()=>e.children),m(_,S)};H(T,_=>{e.children&&_(u)})}s(k),m(v,k)};H(i,v=>{n()&&v(f)})}m(c,a),nt()}function _e(c,e,n,o){confirm("Delete all tasks?")&&V(n,F(o()))}function pe(c,e,n,o){let a=e().filter(i=>i.finished==!1);a.length==0?V(n,F(o())):V(n,F(a))}var ge=(c,e)=>g(e,!t(e)),we=y('<button class="btn btn-secondary option-btn svelte-1wamo6n"><i class="bi bi-x-octagon svelte-1wamo6n"></i> Delete Completed</button> <button class="btn btn-danger option-btn svelte-1wamo6n"><i class="bi bi-x-octagon svelte-1wamo6n"></i> Delete All</button>',1),ke=(c,e,n)=>e()!=null?e()(t(n).finished):null,ye=y('<i class="bi bi-check-square-fill svelte-1wamo6n"></i>'),Se=y('<i class="bi bi-check-square svelte-1wamo6n"></i>'),De=y('<div class="center-hz todo-item svelte-1wamo6n"><input type="checkbox" class="btn-check svelte-1wamo6n" autocomplete="off"> <label class="btn btn-outline svelte-1wamo6n" style="border: none;"><!></label> <input class="todo-name svelte-1wamo6n" aria-label="Todo name"></div>'),Te=(c,e,n,o)=>{e(n().length-1)},Ie=y('<div class="center-vt todo-list svelte-1wamo6n"><div class="list-header svelte-1wamo6n"><h3 style="color: white; margin: 0px;" class="svelte-1wamo6n">Task List</h3> <button class="btn btn-outline svelte-1wamo6n" aria-label="Open todo list options"><i class="bi bi-three-dots-vertical svelte-1wamo6n"></i></button></div> <!> <!> <div class="center-hz todo-item mt-3 svelte-1wamo6n"><button class="btn btn-secondary svelte-1wamo6n">Add Task</button></div></div>');function xe(c,e){at(e,!0);const[n,o]=Ft(),a=()=>ct(v,"$todos",n);let i=R(e,"onFinish",3,void 0);function f(){return[{name:"",finished:!1}]}const v=vt("todos",f(),f());function k(r){return`todo-item-${Math.min(Math.max(0,r),a().length-1)}-input`}function T(r){V(v,F([...a().slice(0,r+1),{id:Date.now(),name:"",finished:!1},...a().slice(r+1)])),yt().then(()=>{document.getElementById(k(r+1)).focus()})}function u(r,b){var M,D;console.log(r.key),r.key=="Enter"&&a()[b].name!=""?(r.preventDefault(),T(b)):(r.key=="Backspace"||r.key=="Delete")&&a()[b].name==""&&a().length>1?(r.preventDefault(),V(v,F([...a().slice(0,b),...a().slice(b+1)])),yt().then(()=>{var I;(I=document.getElementById(k(b-1)))==null||I.focus()})):r.key=="ArrowUp"?(M=document.getElementById(k(b-1)))==null||M.focus():r.key=="ArrowDown"&&((D=document.getElementById(k(b+1)))==null||D.focus())}let _=A(!1);var S=Ie(),h=l(S),N=w(l(h),2);N.__click=[ge,_],s(h);var E=w(h,2);be(E,{get visible(){return t(_)},set visible(r){g(_,F(r))},children:(r,b)=>{var M=we(),D=et(M);D.__click=[pe,a,v,f];var I=w(D,2);I.__click=[_e,a,v,f],m(r,M)},$$slots:{default:!0}});var z=w(E,2);It(z,1,a,xt,(r,b,M)=>{var D=De(),I=l(D);mt(I),j(I,"id",`todo-btn-${M??""}`),I.__change=[ke,i,b];var $=w(I,2);j($,"for",`todo-btn-${M??""}`);var q=l($);{var X=x=>{var K=ye();m(x,K)},Z=x=>{var K=Se();m(x,K)};H(q,x=>{t(b).finished?x(X):x(Z,!1)})}s($);var B=w($,2);mt(B),j(B,"id",`todo-item-${M}-input`),B.__keydown=x=>u(x,M),s(D),W(()=>st(D,"finished",t(b).finished)),Wt(I,()=>t(b).finished,x=>(t(b).finished=x,St(n,"$todos"))),Mt(B,()=>t(b).name,x=>(t(b).name=x,St(n,"$todos"))),m(r,D)});var J=w(z,2),Q=l(J);Q.__click=[Te,T,a,v],s(J),s(S),m(c,S),nt(),o()}Tt(["click","change","keydown"]);var Me=y('<span class="svelte-1qmb3u9"><i class="bi bi-x"></i><!></span>');function Fe(c,e){at(e,!0);const n=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1});var o=Me(),a=w(l(o));Et(a,{get amount(){return e.amount},formatter:n}),s(o),m(c,o),nt()}var Pe=y('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-1f3o6pd"> </label>',1),Le=y('<link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""> <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&amp;display=swap" rel="stylesheet">  <div class="menu-bar svelte-1f3o6pd"><!> <!> <i class="bi bi-circle"></i></div> <br> <div class="center-hz svelte-1f3o6pd"><div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div></div> <div class="blocky-container mt-5 svelte-1f3o6pd"><div class="svelte-1f3o6pd"></div> <div style="margin-bottom: 70px;" class="svelte-1f3o6pd"><!></div> <div class="center-hz svelte-1f3o6pd"><!></div></div>',1);function Je(c,e){at(e,!0);const[n,o]=Ft(),a=()=>ct(N,"$storeLastStart",n),i=()=>ct(h,"$storeLastFinish",n),f=()=>ct(S,"$storeMultiplierSum",n),v=()=>ct(_,"$storePoints",n),k=[],T={work:new pt({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new pt({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new pt({name:"Long Break",length:10,color:"#237047",reward:450})};let u=A("work");const _=vt("points",0,null),S=vt("multiplier",1,null),h=vt("lastFinish",0,0),N=vt("lastStart",0,0);let E=A(1);function z(){let P=a()>i()?a()-i():Date.now()-i();const d=15*60*1e3;g(E,F(Math.max(1,f()-Math.pow(P/d,4))))}Dt(()=>{const P=setInterval(z,5e3);return()=>clearInterval(P)}),z();function J(){V(N,F(Date.now())),z()}let Q=0;function r(P,d,p){V(_,v()+d),V(h,F(Date.now())),V(S,t(E)+P*.1),z(),p&&(t(u)=="work"?(Q+=P,Q>=T.work.length*3.4?(Q=0,g(u,"longbreak")):g(u,"break")):g(u,"work"))}function b(P){V(_,v()+200*(P?1:-1))}var M=Le(),D=w(et(M),6),I=l(D);Fe(I,{get amount(){return t(E)}});var $=w(I,2);Nt($,{get amount(){return v()}}),Gt(2),s(D);var q=w(D,4),X=l(q);It(X,21,()=>Object.entries(T),xt,(P,d)=>{let p=()=>t(d)[0],L=()=>t(d)[1];var C=Pe(),U=et(C);mt(U);var Y,ot=w(U,2),ht=l(ot,!0);s(ot),W(()=>{j(U,"id",`radio-${p()}`),Y!==(Y=p())&&(U.value=(U.__value=p())==null?"":p()),j(ot,"for",`radio-${p()}`),j(ot,"style",t(u)==p()?`background-color: ${L().color};`:""),dt(ht,L().name)}),Ht(k,[],U,()=>(p(),t(u)),bt=>g(u,bt)),m(P,C)}),s(X),s(q);var Z=w(q,2),B=w(l(Z),2),x=l(B);Lt(x,()=>t(u),P=>{fe(P,{get mode(){return T[t(u)]},onFinish:r,onStart:J})}),s(B);var K=w(B,2),ft=l(K);xe(ft,{onFinish:b}),s(K),s(Z),m(c,M),nt(),o()}export{Je as component};
