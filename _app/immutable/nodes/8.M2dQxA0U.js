import{a as g,t as b,c as Oe}from"../chunks/D8IZ5tij.js";import{aH as xe,aI as Re,aJ as Be,o as Ue,x as te,G as Ve,N as We,q as Ge,y as He,aa as Je,aE as Te,au as Ke,P as je,g as Xe,p as ge,c,r as v,t as C,a as be,f as ue,s as m,ac as N,i as e,aK as Ze,aL as Qe,l as F,a8 as h,b as Ye}from"../chunks/DRP5GfAB.js";import{l as Ie,s as J,d as $e,e as ea,a as aa}from"../chunks/DcfRItNb.js";import{e as ta,i as ra}from"../chunks/Duy6D2ej.js";import{s as K,r as me}from"../chunks/KYYcMl7V.js";import{i as sa,p as R}from"../chunks/DlRuioKL.js";import{p as B,i as W}from"../chunks/kFZv4Qm8.js";import{t as _e}from"../chunks/Bvena8yX.js";import{r as ia}from"../chunks/BfgKyPlE.js";import{a as la}from"../chunks/xSQF6w4t.js";import{s as oa}from"../chunks/DzRVWYVD.js";function Ee(t,a,s){te&&Ve();var l=t,o=Je,r,i=xe()?Re:Be;Ue(()=>{i(o,o=a())&&(r&&We(r),r=Ge(()=>s(l)))}),te&&(l=He)}function ve(t,a,s=a){var l=xe();Ie(t,"input",o=>{var r=o?t.defaultValue:t.value;if(r=de(t)?he(r):r,s(r),l&&r!==(r=a())){var i=t.selectionStart,u=t.selectionEnd;t.value=r??"",u!==null&&(t.selectionStart=i,t.selectionEnd=Math.min(u,t.value.length))}}),(te&&t.defaultValue!==t.value||Xe(a)==null&&t.value)&&s(de(t)?he(t.value):t.value),Te(()=>{var o=a();de(t)&&o===he(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}const ce=new Set;function na(t,a,s,l,o=l){var r=s.getAttribute("type")==="checkbox",i=t;let u=!1;if(a!==null)for(var f of a)i=i[f]??(i[f]=[]);i.push(s),Ie(s,"change",()=>{var n=s.__value;r&&(n=Se(i,n,s.checked)),o(n)},()=>o(r?[]:null)),Te(()=>{var n=l();if(te&&s.defaultChecked!==s.checked){u=!0;return}r?(n=n||[],s.checked=n.includes(s.__value)):s.checked=sa(s.__value,n)}),Ke(()=>{var n=i.indexOf(s);n!==-1&&i.splice(n,1)}),ce.has(i)||(ce.add(i),je(()=>{i.sort((n,k)=>n.compareDocumentPosition(k)===4?-1:1),ce.delete(i)})),je(()=>{if(u){var n;if(r)n=Se(i,n,s.checked);else{var k=i.find(_=>_.checked);n=k==null?void 0:k.__value}o(n)}})}function Se(t,a,s){for(var l=new Set,o=0;o<t.length;o+=1)t[o].checked&&l.add(t[o].__value);return s||l.delete(a),Array.from(l)}function de(t){var a=t.type;return a==="number"||a==="range"}function he(t){return t===""?null:+t}var va=b('<div style="aspect-ratio: 1/1; display: inline-block;"><div class="backing svelte-efxvsm"><div><!></div></div></div>');function ca(t,a){ge(a,!0);let s=B(a,"borderRadius",3,"10px"),l=B(a,"progress",7,0),o=B(a,"color",3,"rgb(153, 86, 86)"),r=B(a,"extraPadding",3,"18px");l(Math.max(1,l()));var i=va(),u=c(i),f=c(u),n=c(f);{var k=_=>{var p=Oe(),T=ue(p);oa(T,()=>a.children),g(_,p)};W(n,_=>{a.children&&_(k)})}v(f),v(u),v(i),C(()=>K(u,"style",`--ring-width: ${s()??""}; --progress: ${l()??""}%; --ring-color: ${o()??""}; --extra-padding: ${r()??""};`)),g(t,i),be()}var da=b('<span class="points svelte-1wf4o1b"> </span>'),ha=b('<span class="point-view svelte-1wf4o1b">ðŸª™ <!></span>');function Ne(t,a){let s=a.amount==null;var l=ha(),o=m(c(l));Ee(o,()=>a.amount,r=>{var i=da(),u=c(i,!0);v(i),C(()=>J(u,a.amount)),g(r,i)}),v(l),C(()=>{_e(l,"hide-first",s),_e(l,"hide-first-reveal",a.amount!=null&&s)}),g(t,l)}var fa=b('<textarea id="timer-name-edit" class="svelte-1ihjghp"></textarea>'),ua=b('<span style="font-style: italic; color: #bbbE;" class="svelte-1ihjghp"> </span>'),ma=b('<div class="svelte-1ihjghp"><div class="center-hz svelte-1ihjghp" style="color: #bbbE;"> </div> <h1 class="timer-text center-hz svelte-1ihjghp"> </h1> <div class="timer-task center-vt svelte-1ihjghp"><div class="center-hz svelte-1ihjghp"><!></div></div></div>'),_a=(t,a)=>a(!0),ga=b('<button class="btn btn-secondary svelte-1ihjghp" aria-label="finish current task"><i class="bi bi-check-circle svelte-1ihjghp"></i></button>'),ba=b('<button class="btn btn-danger svelte-1ihjghp" aria-label="resume"><i class="bi bi-play-fill svelte-1ihjghp"></i></button>'),ka=b('<button class="btn btn-secondary svelte-1ihjghp" aria-label="pause"><i class="bi bi-pause-fill svelte-1ihjghp"></i></button>'),pa=b('<div class="appear svelte-1ihjghp"><!> <div class="timer-btns center-hz appear mt-3 svelte-1ihjghp"><button class="btn btn-secondary svelte-1ihjghp">Cash Out <!></button> <!> <!></div></div>'),wa=b('<div class="form-group svelte-1ihjghp"><label class="svelte-1ihjghp">What would you like to work on? <input class="form-control svelte-1ihjghp" placeholder="Set task name"></label></div>'),ya=b('<div class="center-vt svelte-1ihjghp"><div class="form-group svelte-1ihjghp"><label class="svelte-1ihjghp">Duration: <input class="form-control svelte-1ihjghp" type="number" min="1" max="50"></label></div> <!> <button class="btn btn-primary mt-4 svelte-1ihjghp">Start</button></div>'),ja=b('<div class="center-hz svelte-1ihjghp"><div class="center-vt svelte-1ihjghp"><div class="center-hz svelte-1ihjghp"></div> <div class="center-hz svelte-1ihjghp"><!></div></div></div>');function Sa(t,a){ge(a,!0);let s=B(a,"taskName",15,void 0),l=B(a,"onFinish",3,void 0),o=B(a,"onTaskFinish",3,void 0),r=N(!1),i=N(!1),u=N(R(a.mode.length)),f=F(()=>e(u)*60),n=N(R(new Date)),k=N(void 0),_=N(0),p=N(0),T=F(()=>e(_)+e(p)),U=F(()=>Math.max(0,e(f)-e(T))),X=F(()=>Math.floor(e(U)/60)%60),I=F(()=>Math.round(e(U))%60),j=F(()=>new Date(e(n).getTime()+(e(f)-e(p))*1e3)),w=F(()=>Math.round(e(T)/e(f)*100)),P=[10,5,2,1];function G(){let d=(new Date-e(n))/1e3;if(d>e(f))h(_,R(e(f))),z(!0),M("Pomodoro","Out of time"),alert("Ran out of time to cash out.");else{for(h(_,d);P[0]>=e(u);)P=P.slice(1);e(U)<P[0]*60&&(M("Pomodoro",`${(e(U)/60).toFixed(2)} minutes remaining.`),P=P.slice(1))}}function M(d,S,x="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let L={body:S,img:""};x!=null&&(L.tag=x),new Notification(d,L)}}function V(){Notification.requestPermission().then(d=>{}),h(r,!0),h(i,!1),e(_)!=0&&(h(p,e(p)+e(_)),h(_,0)),h(n,R(new Date)),G(),h(k,R(setInterval(G,1e3)))}function z(d=!1){l()(e(T)/60,d),h(r,!1),h(i,!1),clearInterval(e(k)),h(_,0),h(p,0)}function Z(){h(i,!0),clearInterval(e(k))}la(()=>{e(r)&&z(!1)});function Q(){o()(s()),document.getElementById("timer-name-edit").select()}var re=ja();ea("keydown",Ze,d=>{d.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),e(r)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&(d.key==" "?(e(i)?V():Z(),d.preventDefault()):d.key=="f"&&s()!=null&&confirm("Finish task: "+s())&&(Q(),d.preventDefault()))}),aa(d=>{C((S,x)=>Qe.title=`${S??""}:${x??""} - Pomodoro`,[()=>e(X).toString().padStart(2,"0"),()=>e(I).toString().padStart(2,"0")])});var ke=c(re),pe=m(c(ke),2),Pe=c(pe);{var Me=d=>{var S=pa(),x=c(S);ca(x,{get progress(){return e(w)},get color(){return a.mode.color},children:(y,D)=>{var le=ma(),oe=c(le),ze=c(oe,!0);v(oe);var ae=m(oe,2),Le=c(ae);v(ae);var we=m(ae,2),ye=c(we),qe=c(ye);{var Ae=A=>{var E=fa();ia(E),C(()=>K(E,"placeholder",a.mode.name)),ve(E,s),g(A,E)},Ce=A=>{var E=ua(),ne=c(E,!0);v(E),C(()=>J(ne,a.mode.name)),g(A,E)};W(qe,A=>{a.mode.hasTask?A(Ae):A(Ce,!1)})}v(ye),v(we),v(le),C((A,E,ne)=>{J(ze,A),_e(ae,"paused",e(i)),J(Le,`${E??""}:${ne??""}`)},[()=>e(j).toLocaleTimeString(),()=>e(X).toString().padStart(2,"0"),()=>e(I).toString().padStart(2,"0")]),g(y,le)},$$slots:{default:!0}});var L=m(x,2),O=c(L);O.__click=[_a,z];var Y=m(c(O));const se=F(()=>a.mode.calcScore(e(T)/60));var ie=F(()=>e(se));Ne(Y,{get amount(){return e(ie)}}),v(O);var q=m(O,2);{var H=y=>{var D=ga();D.__click=Q,g(y,D)};W(q,y=>{a.mode.hasTask&&y(H)})}var $=m(q,2);{var ee=y=>{var D=ba();D.__click=V,g(y,D)},Fe=y=>{var D=ka();D.__click=Z,g(y,D)};W($,y=>{e(i)?y(ee):y(Fe,!1)})}v(L),v(S),g(d,S)},De=d=>{var S=ya(),x=c(S),L=c(x),O=m(c(L));me(O),v(L),v(x);var Y=m(x,2);{var se=q=>{var H=wa(),$=c(H),ee=m(c($));me(ee),v($),v(H),ve(ee,s),g(q,H)};W(Y,q=>{a.mode.hasTask&&q(se)})}var ie=m(Y,2);ie.__click=V,v(S),ve(O,()=>e(u),q=>h(u,q)),g(d,S)};W(Pe,d=>{e(r)?d(Me):d(De,!1)})}v(pe),v(ke),v(re),g(t,re),be()}$e(["click"]);class fe{constructor({name:a,length:s,color:l,reward:o,hasTask:r=!1}){this.name=a,this.length=s,this.color=l,this.reward=o,this.hasTask=r}calcScore(a){let s=10;return a<1?0:Math.round(1/(1+Math.pow(Math.E,-((a-this.length/2)*(s/this.length))))*this.reward)}}var xa=b('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-1w7m3ok"> </label>',1),Ta=b('<br> <br>  <div class="menu-bar mb-3 svelte-1w7m3ok"><div></div> <div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> <!></div> <!>',1);function Ca(t,a){ge(a,!0);const s=[],l={work:new fe({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new fe({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new fe({name:"Long Break",length:10,color:"#237047",reward:450})};let o=N(""),r=N("work"),i=0;function u(I,j){{let w=parseInt(localStorage.getItem("points"));w&&(j=parseInt(w))}return j}let f=N(R(u("points",0)));Ye(()=>{localStorage.setItem("points",e(f))});function n(I,j){h(f,e(f)+l[e(r)].calcScore(I)),j&&(e(r)=="work"?(i+=I,i>=l.work.length*3.4?(i=0,h(r,"longbreak")):h(r,"break")):h(r,"work"))}function k(){h(f,e(f)+1e3)}var _=Ta(),p=m(ue(_),4),T=m(c(p),2);ta(T,21,()=>Object.entries(l),ra,(I,j)=>{let w=()=>e(j)[0],P=()=>e(j)[1];var G=xa(),M=ue(G);me(M);var V,z=m(M,2),Z=c(z,!0);v(z),C(()=>{K(M,"id",`radio-${w()}`),V!==(V=w())&&(M.value=(M.__value=w())==null?"":w()),K(z,"for",`radio-${w()}`),K(z,"style",e(r)==w()?`background-color: ${P().color};`:""),J(Z,P().name)}),na(s,[],M,()=>(w(),e(r)),Q=>h(r,Q)),g(I,G)}),v(T);var U=m(T,2);Ne(U,{get amount(){return e(f)}}),v(p);var X=m(p,2);Ee(X,()=>e(r),I=>{Sa(I,{get mode(){return l[e(r)]},onFinish:n,onTaskFinish:k,get taskName(){return e(o)},set taskName(j){h(o,R(j))}})}),g(t,_),be()}export{Ca as component};
