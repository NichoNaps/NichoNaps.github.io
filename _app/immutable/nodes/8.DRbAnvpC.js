import{a as g,t as k,c as Ae}from"../chunks/BCe9DMxx.js";import{aH as xe,aI as Ce,aJ as Oe,o as Re,x as ae,G as Be,P as Ue,q as Ve,y as We,aa as Ge,aE as Te,au as He,R as we,g as Je,p as me,c,r as v,t as O,a as ge,f as fe,ac as T,s as m,i as e,aK as Ke,aL as Xe,l as M,a8 as d}from"../chunks/Cwxz4zsB.js";import{l as Se,s as J,d as Ze,e as Qe,a as Ye}from"../chunks/D0_HKjy9.js";import{e as $e,i as ea}from"../chunks/BOdTrU8H.js";import{s as K,r as ue}from"../chunks/C9H9V2QD.js";import{i as aa,p as U}from"../chunks/BAXBLNLT.js";import{p as R,i as V}from"../chunks/D_0EBigx.js";import{t as ta}from"../chunks/Bvena8yX.js";import{r as ra}from"../chunks/CGLGJUg4.js";import{a as sa}from"../chunks/BHrwyQfe.js";import{s as ia}from"../chunks/D9c0H0XM.js";function la(a,t,r){ae&&Be();var l=a,o=Ge,s,i=xe()?Ce:Oe;Re(()=>{i(o,o=t())&&(s&&Ue(s),s=Ve(()=>r(l)))}),ae&&(l=We)}function ne(a,t,r=t){var l=xe();Se(a,"input",o=>{var s=o?a.defaultValue:a.value;if(s=ce(a)?de(s):s,r(s),l&&s!==(s=t())){var i=a.selectionStart,h=a.selectionEnd;a.value=s??"",h!==null&&(a.selectionStart=i,a.selectionEnd=Math.min(h,a.value.length))}}),(ae&&a.defaultValue!==a.value||Je(t)==null&&a.value)&&r(ce(a)?de(a.value):a.value),Te(()=>{var o=t();ce(a)&&o===de(a.value)||a.type==="date"&&!o&&!a.value||o!==a.value&&(a.value=o??"")})}const ve=new Set;function oa(a,t,r,l,o=l){var s=r.getAttribute("type")==="checkbox",i=a;let h=!1;if(t!==null)for(var _ of t)i=i[_]??(i[_]=[]);i.push(r),Se(r,"change",()=>{var n=r.__value;s&&(n=je(i,n,r.checked)),o(n)},()=>o(s?[]:null)),Te(()=>{var n=l();if(ae&&r.defaultChecked!==r.checked){h=!0;return}s?(n=n||[],r.checked=n.includes(r.__value)):r.checked=aa(r.__value,n)}),He(()=>{var n=i.indexOf(r);n!==-1&&i.splice(n,1)}),ve.has(i)||(ve.add(i),we(()=>{i.sort((n,b)=>n.compareDocumentPosition(b)===4?-1:1),ve.delete(i)})),we(()=>{if(h){var n;if(s)n=je(i,n,r.checked);else{var b=i.find(u=>u.checked);n=b==null?void 0:b.__value}o(n)}})}function je(a,t,r){for(var l=new Set,o=0;o<a.length;o+=1)a[o].checked&&l.add(a[o].__value);return r||l.delete(t),Array.from(l)}function ce(a){var t=a.type;return t==="number"||t==="range"}function de(a){return a===""?null:+a}var na=k('<div style="aspect-ratio: 1/1; display: inline-block;"><div class="backing svelte-efxvsm"><div><!></div></div></div>');function va(a,t){me(t,!0);let r=R(t,"borderRadius",3,"10px"),l=R(t,"progress",7,0),o=R(t,"color",3,"rgb(153, 86, 86)"),s=R(t,"extraPadding",3,"18px");l(Math.max(1,l()));var i=na(),h=c(i),_=c(h),n=c(_);{var b=u=>{var p=Ae(),D=fe(p);ia(D,()=>t.children),g(u,p)};V(n,u=>{t.children&&u(b)})}v(_),v(h),v(i),O(()=>K(h,"style",`--ring-width: ${r()??""}; --progress: ${l()??""}%; --ring-color: ${o()??""}; --extra-padding: ${s()??""};`)),g(a,i),ge()}var ca=k('<span class="point-view svelte-15t8e2c"> </span>');function Ee(a,t){var r=ca(),l=c(r);v(r),O(()=>J(l,`ðŸª™ ${t.amount??""}`)),g(a,r)}var da=k('<textarea id="timer-name-edit" class="svelte-1ihjghp"></textarea>'),ha=k('<span style="font-style: italic; color: #bbbE;" class="svelte-1ihjghp"> </span>'),fa=k('<div class="svelte-1ihjghp"><div class="center-hz svelte-1ihjghp" style="color: #bbbE;"> </div> <h1 class="timer-text center-hz svelte-1ihjghp"> </h1> <div class="timer-task center-vt svelte-1ihjghp"><div class="center-hz svelte-1ihjghp"><!></div></div></div>'),ua=k('<button class="btn btn-secondary svelte-1ihjghp" aria-label="finish current task"><i class="bi bi-check-circle svelte-1ihjghp"></i></button>'),ma=k('<button class="btn btn-danger svelte-1ihjghp" aria-label="resume"><i class="bi bi-play-fill svelte-1ihjghp"></i></button>'),ga=k('<button class="btn btn-secondary svelte-1ihjghp" aria-label="pause"><i class="bi bi-pause-fill svelte-1ihjghp"></i></button>'),_a=k('<div class="appear svelte-1ihjghp"><!> <div class="timer-btns center-hz appear mt-3 svelte-1ihjghp"><button class="btn btn-secondary svelte-1ihjghp" aria-label="quit timer early">Cash Out <!></button> <!> <!></div></div>'),ba=k('<div class="form-group svelte-1ihjghp"><label class="svelte-1ihjghp">What would you like to work on? <input class="form-control svelte-1ihjghp" placeholder="Set task name"></label></div>'),ka=k('<div class="center-vt svelte-1ihjghp"><div class="form-group svelte-1ihjghp"><label class="svelte-1ihjghp">Duration: <input class="form-control svelte-1ihjghp" type="number" min="1" max="50"></label></div> <!> <button class="btn btn-primary mt-4 svelte-1ihjghp">Start</button></div>'),pa=k('<div class="center-hz svelte-1ihjghp"><div class="center-vt svelte-1ihjghp"><div class="center-hz svelte-1ihjghp"></div> <div class="center-hz svelte-1ihjghp"><!></div></div></div>');function ya(a,t){me(t,!0);let r=R(t,"taskName",15,void 0),l=R(t,"onFinish",3,void 0),o=R(t,"onTaskFinish",3,void 0),s=T(!1),i=T(!1),h=T(U(t.mode.length)),_=M(()=>e(h)*60),n=T(U(new Date)),b=T(void 0),u=T(0),p=T(0),D=M(()=>e(u)+e(p)),B=M(()=>Math.max(0,e(_)-e(D))),S=M(()=>Math.floor(e(B)/60)%60),A=M(()=>Math.round(e(B))%60),E=M(()=>new Date(e(n).getTime()+(e(_)-e(p))*1e3)),X=M(()=>Math.round(e(D)/e(_)*100)),I=[10,5,2,1];function P(){let f=(new Date-e(n))/1e3;if(f>e(_))d(u,U(e(_))),G(),W("Pomodoro","Out of time"),l()!=null;else{for(d(u,f);I[0]>=e(h);)I=I.slice(1);e(B)<I[0]*60&&(W("Pomodoro",`${(e(B)/60).toFixed(2)} minutes remaining.`),I=I.slice(1))}}function W(f,w,j="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let q={body:w,img:""};j!=null&&(q.tag=j),new Notification(f,q)}}function F(){Notification.requestPermission().then(f=>{}),d(s,!0),d(i,!1),e(u)!=0&&(d(p,e(p)+e(u)),d(u,0)),d(n,U(new Date)),P(),d(b,U(setInterval(P,1e3)))}function G(){l()(e(D)/60),d(s,!1),d(i,!1),clearInterval(e(b)),d(u,0),d(p,0)}function Z(){d(i,!0),clearInterval(e(b))}sa(()=>{e(s)&&G()});function _e(){o()(r()),document.getElementById("timer-name-edit").select()}var te=pa();Qe("keydown",Ke,f=>{f.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),e(s)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&(f.key==" "?(e(i)?F():Z(),f.preventDefault()):f.key=="f"&&r()!=null&&confirm("Finish task: "+r())&&(_e(),f.preventDefault()))}),Ye(f=>{O((w,j)=>Xe.title=`${w??""}:${j??""} - Pomodoro`,[()=>e(S).toString().padStart(2,"0"),()=>e(A).toString().padStart(2,"0")])});var be=c(te),ke=m(c(be),2),Ie=c(ke);{var Pe=f=>{var w=_a(),j=c(w);va(j,{get progress(){return e(X)},get color(){return t.mode.color},children:(y,N)=>{var ie=fa(),le=c(ie),De=c(le,!0);v(le);var ee=m(le,2),Fe=c(ee);v(ee);var pe=m(ee,2),ye=c(pe),qe=c(ye);{var ze=L=>{var x=da();ra(x),O(()=>K(x,"placeholder",t.mode.name)),ne(x,r),g(L,x)},Le=L=>{var x=ha(),oe=c(x,!0);v(x),O(()=>J(oe,t.mode.name)),g(L,x)};V(qe,L=>{t.mode.hasTask?L(ze):L(Le,!1)})}v(ye),v(pe),v(ie),O((L,x,oe)=>{J(De,L),ta(ee,"paused",e(i)),J(Fe,`${x??""}:${oe??""}`)},[()=>e(E).toLocaleTimeString(),()=>e(S).toString().padStart(2,"0"),()=>e(A).toString().padStart(2,"0")]),g(y,ie)},$$slots:{default:!0}});var q=m(j,2),C=c(q);C.__click=G;var Q=m(c(C));const re=M(()=>t.mode.calcScore(e(D)/60));var se=M(()=>e(re));Ee(Q,{get amount(){return e(se)}}),v(C);var z=m(C,2);{var H=y=>{var N=ua();N.__click=_e,g(y,N)};V(z,y=>{t.mode.hasTask&&y(H)})}var Y=m(z,2);{var $=y=>{var N=ma();N.__click=F,g(y,N)},Me=y=>{var N=ga();N.__click=Z,g(y,N)};V(Y,y=>{e(i)?y($):y(Me,!1)})}v(q),v(w),g(f,w)},Ne=f=>{var w=ka(),j=c(w),q=c(j),C=m(c(q));ue(C),v(q),v(j);var Q=m(j,2);{var re=z=>{var H=ba(),Y=c(H),$=m(c(Y));ue($),v(Y),v(H),ne($,r),g(z,H)};V(Q,z=>{t.mode.hasTask&&z(re)})}var se=m(Q,2);se.__click=F,v(w),ne(C,()=>e(h),z=>d(h,z)),g(f,w)};V(Ie,f=>{e(s)?f(Pe):f(Ne,!1)})}v(ke),v(be),v(te),g(a,te),ge()}Ze(["click"]);class he{constructor({name:t,length:r,color:l,reward:o,hasTask:s=!1}){this.name=t,this.length=r,this.color=l,this.reward=o,this.hasTask=s}calcScore(t){let r=10;return t<1?0:Math.round(1/(1+Math.pow(Math.E,-((t-this.length/2)*(r/this.length))))*this.reward)}}var wa=k('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-12sfgq9"> </label>',1),ja=k('<br> <br>  <div class="center-hz mb-3 svelte-12sfgq9"><div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> <!></div> <!>',1);function za(a,t){me(t,!0);const r=[],l={work:new he({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new he({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new he({name:"Long Break",length:10,color:"#237047",reward:450})};let o=T(""),s=T("work"),i=0,h=T(0);function _(S){d(h,e(h)+l[e(s)].calcScore(S)),e(s)=="work"?(i+=S,i>=l.work.length*3.4?(i=0,d(s,"longbreak")):d(s,"break")):d(s,"work")}function n(){d(h,e(h)+1e3)}var b=ja(),u=m(fe(b),4),p=c(u);$e(p,21,()=>Object.entries(l),ea,(S,A)=>{let E=()=>e(A)[0],X=()=>e(A)[1];var I=wa(),P=fe(I);ue(P);var W,F=m(P,2),G=c(F,!0);v(F),O(()=>{K(P,"id",`radio-${E()}`),W!==(W=E())&&(P.value=(P.__value=E())==null?"":E()),K(F,"for",`radio-${E()}`),K(F,"style",e(s)==E()?`background-color: ${X().color};`:""),J(G,X().name)}),oa(r,[],P,()=>(E(),e(s)),Z=>d(s,Z)),g(S,I)}),v(p);var D=m(p,2);Ee(D,{get amount(){return e(h)}}),v(u);var B=m(u,2);la(B,()=>e(s),S=>{ya(S,{get mode(){return l[e(s)]},onFinish:_,onTaskFinish:n,get taskName(){return e(o)},set taskName(A){d(o,U(A))}})}),g(a,b),ge()}export{za as component};
