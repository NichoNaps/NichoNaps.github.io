import{a as w,t as p,c as Le}from"../chunks/MMnHFxy9.js";import{aI as we,aJ as qe,aK as Ce,v as Oe,z as Y,I as Je,P as Ue,w as Re,A as Ve,ad as Ke,u as je,b as fe,aB as Ge,q as _e,p as ee,c as f,r as u,t as L,a as te,f as ne,af as z,g as me,s as j,k as e,ab as h,$ as He,m as P,aL as be,aH as ye}from"../chunks/B5J0LM7C.js";import{s as $}from"../chunks/Dbk6mWYv.js";import{e as pe,i as Se}from"../chunks/Qt0AYjcG.js";import{s as q,r as le}from"../chunks/01jRF1C1.js";import{l as he,d as Ie,e as ge,h as Qe}from"../chunks/DYkZnEoQ.js";import{i as We,p as F}from"../chunks/D3QeOjw2.js";import{p as K,i as H}from"../chunks/DGYTFJO3.js";import{t as Q}from"../chunks/CvA-ELdm.js";import{a as Xe}from"../chunks/DgceO5va.js";import{s as Ze}from"../chunks/DwneK0bJ.js";function Te(r,t,n){Y&&Je();var l=r,a=Ke,i,v=we()?qe:Ce;Oe(()=>{v(a,a=t())&&(i&&Ue(i),i=Re(()=>n(l)))}),Y&&(l=Ve)}function De(r,t,n=t){var l=we();he(r,"input",a=>{var i=a?r.defaultValue:r.value;if(i=ce(r)?de(i):i,n(i),l&&i!==(i=t())){var v=r.selectionStart,m=r.selectionEnd;r.value=i??"",m!==null&&(r.selectionStart=v,r.selectionEnd=Math.min(m,r.value.length))}}),(Y&&r.defaultValue!==r.value||je(t)==null&&r.value)&&n(ce(r)?de(r.value):r.value),fe(()=>{var a=t();ce(r)&&a===de(r.value)||r.type==="date"&&!a&&!r.value||a!==r.value&&(r.value=a??"")})}const ve=new Set;function Ye(r,t,n,l,a=l){var i=n.getAttribute("type")==="checkbox",v=r;let m=!1;if(t!==null)for(var y of t)v=v[y]??(v[y]=[]);v.push(n),he(n,"change",()=>{var o=n.__value;i&&(o=ke(v,o,n.checked)),a(o)},()=>a(i?[]:null)),fe(()=>{var o=l();if(Y&&n.defaultChecked!==n.checked){m=!0;return}i?(o=o||[],n.checked=o.includes(n.__value)):n.checked=We(n.__value,o)}),Ge(()=>{var o=v.indexOf(n);o!==-1&&v.splice(o,1)}),ve.has(v)||(ve.add(v),_e(()=>{v.sort((o,_)=>o.compareDocumentPosition(_)===4?-1:1),ve.delete(v)})),_e(()=>{if(m){var o;if(i)o=ke(v,o,n.checked);else{var _=v.find(S=>S.checked);o=_==null?void 0:_.__value}a(o)}})}function $e(r,t,n=t){he(r,"change",l=>{var a=l?r.defaultChecked:r.checked;n(a)}),(Y&&r.defaultChecked!==r.checked||je(t)==null)&&n(r.checked),fe(()=>{var l=t();r.checked=!!l})}function ke(r,t,n){for(var l=new Set,a=0;a<r.length;a+=1)r[a].checked&&l.add(r[a].__value);return n||l.delete(t),Array.from(l)}function ce(r){var t=r.type;return t==="number"||t==="range"}function de(r){return r===""?null:+r}var et=p('<div><div class="backing svelte-efxvsm"><div><!></div></div></div>');function tt(r,t){ee(t,!0);let n=K(t,"borderRadius",3,"10px"),l=K(t,"progress",7,0),a=K(t,"color",3,"rgb(153, 86, 86)"),i=K(t,"extraPadding",3,"18px"),v=K(t,"style",3,"");l(Math.max(1,l()));var m=et(),y=f(m),o=f(y),_=f(o);{var S=s=>{var c=Le(),g=ne(c);Ze(g,()=>t.children),w(s,c)};H(_,s=>{t.children&&s(S)})}u(o),u(y),u(m),L(()=>{q(m,"style",`aspect-ratio: 1/1; display: inline-block; ${v()??""}`),q(y,"style",`--ring-width: ${n()??""}; --progress: ${l()??""}%; --ring-color: ${a()??""}; --extra-padding: ${i()??""};`)}),w(r,m),te()}var at=p('<span class="points-change svelte-15n4znc"> </span>'),rt=p('<!> <span class="points svelte-15n4znc"> </span>',1),nt=p('<span class="point-view svelte-15n4znc">ðŸª™ <!></span>');function Ee(r,t){ee(t,!0);let n=t.amount==null,l=z(0),a=z(F(t.amount));me(()=>{t.amount!=e(a)&&(h(l,t.amount-e(a)),h(a,F(t.amount)))});var i=nt(),v=j(f(i));Te(v,()=>t.amount,m=>{var y=rt(),o=ne(y);{var _=c=>{var g=at(),k=f(g);u(g),L(T=>{q(g,"style",`color: ${(e(l)>=0?"#0F0":"#F00")??""};`),$(k,`${(e(l)>0?"+":"-")??""}${T??""}`)},[()=>Math.abs(e(l))]),w(c,g)};H(o,c=>{e(l)!=0&&c(_)})}var S=j(o,2),s=f(S,!0);u(S),L(()=>$(s,t.amount)),w(m,y)}),u(i),L(()=>{Q(i,"hide-first",n),Q(i,"hide-first-reveal",t.amount!=null&&n)}),w(r,i),te()}var lt=(r,t)=>confirm("Quit timer without cashing out?")?t(!0,!1):null,it=p('<button class="btn btn-danger svelte-vyjiyu" aria-label="resume"><i class="bi bi-play-fill svelte-vyjiyu"></i></button>'),st=p('<button class="btn btn-outline svelte-vyjiyu" aria-label="pause"><i class="bi bi-pause-fill svelte-vyjiyu"></i></button>'),ot=p('<div class="center-hz svelte-vyjiyu"><button class="btn btn-outline svelte-vyjiyu" aria-label="quit timer without cashing out points"><i class="bi bi-x-circle svelte-vyjiyu"></i></button> <!></div>'),vt=p('<div class="center-hz svelte-vyjiyu"><input class="form-control svelte-vyjiyu" type="number" style="width: 50%;" min="1" max="50"></div>'),ct=p('<div class="svelte-vyjiyu"><div class="center-hz svelte-vyjiyu" style="color: #bbbE;"> </div> <div class="timer-text center-hz svelte-vyjiyu"> </div> <!></div>'),dt=(r,t)=>t(!1,!0),ut=p('<button id="cashout-btn" class="btn btn-secondary btn-lg svelte-vyjiyu">Cash Out <!></button>'),ft=p('<button class="btn btn-primary btn-lg svelte-vyjiyu">Start</button>'),mt=p('<div class="center-hz svelte-vyjiyu"><div class="center-vt svelte-vyjiyu" style="width: 100%;"><div class="appear svelte-vyjiyu"><!> <div class="center-hz mt-4 svelte-vyjiyu"><!></div></div></div></div>');function ht(r,t){ee(t,!0);let n=K(t,"onFinish",3,void 0),l=z(!1),a=z(!1),i=z(F(t.mode.length)),v=P(()=>e(i)*60),m=z(F(new Date)),y=z(void 0),o=z(0),_=z(0),S=P(()=>e(o)+e(_)),s=P(()=>e(v)-e(S)),c=P(()=>Math.floor(Math.abs(e(s))/60)%60),g=P(()=>Math.round(Math.abs(e(s)))%60),k=P(()=>`${e(c).toString().padStart(2,"0")}:${e(g).toString().padStart(2,"0")}`),T=P(()=>new Date(e(m).getTime()+(e(v)-e(_))*1e3)),A=P(()=>Math.min(100,Math.round(e(S)/e(v)*100))),D=[10,5,2,1,0];for(;D[0]>=t.mode.length;)D=D.slice(1);function U(b,x,M="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let O={body:x,img:""};M!=null&&(O.tag=M),new Notification(b,O)}}function E(){h(o,(new Date-e(m))/1e3),e(s)<D[0]*60?(e(s)<0&&D[0]==0?U("Pomodoro","Finished. Good job!"):U("Pomodoro",`${D[0]} minutes remaining.`),D=D.slice(1)):e(s)<0&&D.length==0&&Math.abs(Math.abs(e(s))%60-30)<.6&&U("Pomodoro",`Overtime by ${(Math.abs(e(s))%60).toFixed(1)} minutes.`)}function I(){Notification.requestPermission().then(b=>{}),h(l,!0),h(a,!1),e(o)!=0&&(h(_,e(_)+e(o)),h(o,0)),h(m,F(new Date)),E(),h(y,F(setInterval(E,1e3)))}function d(b=!1,x=!1){let M=e(S)/60;n()(M,b?0:t.mode.calcScore(M,e(i)),x),h(l,!1),h(a,!1),clearInterval(e(y)),h(o,0),h(_,0)}function B(){h(a,!0),clearInterval(e(y))}Xe(()=>{e(l)&&d(!1,!1)});var C=mt();ge("keydown",be,b=>{b.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),e(l)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&b.key==" "&&(e(a)?I():B(),b.preventDefault())}),ge("beforeunload",be,b=>{e(l)&&(b.preventDefault(),b.returnValue=!0)}),Qe(b=>{L(()=>He.title=`${(e(l)?`${e(k)} - `:"")??""}pomodoro`)});var N=f(C),W=f(N),R=f(W);tt(R,{get progress(){return e(A)},get color(){return t.mode.color},style:"width: 100%;",children:(b,x)=>{var M=ct(),O=f(M),se=f(O,!0);u(O);var re=j(O,2),Me=f(re,!0);u(re);var Pe=j(re,2);{var Fe=J=>{var V=ot(),X=f(V);X.__click=[lt,d];var oe=j(X,2);{var Be=G=>{var Z=it();Z.__click=I,w(G,Z)},Ne=G=>{var Z=st();Z.__click=B,w(G,Z)};H(oe,G=>{e(a)?G(Be):G(Ne,!1)})}u(V),w(J,V)},Ae=J=>{var V=vt(),X=f(V);le(X),u(V),De(X,()=>e(i),oe=>h(i,oe)),w(J,V)};H(Pe,J=>{e(l)?J(Fe):J(Ae,!1)})}u(M),L(J=>{$(se,J),Q(re,"paused",e(a)),$(Me,e(k))},[()=>e(T).toLocaleTimeString()]),w(b,M)},$$slots:{default:!0}});var ae=j(R,2),ie=f(ae);{var xe=b=>{var x=ut();x.__click=[dt,d];var M=j(f(x));const O=P(()=>t.mode.calcScore(e(S)/60,e(i)));var se=P(()=>e(O));Ee(M,{get amount(){return e(se)}}),u(x),w(b,x)},ze=b=>{var x=ft();x.__click=I,w(b,x)};H(ie,b=>{e(l)?b(xe):b(ze,!1)})}u(ae),u(W),u(N),u(C),L(()=>{Q(C,"overDone",e(s)<0),Q(C,"almostDone",e(s)<60)}),w(r,C),te()}Ie(["click"]);var _t=(r,t,n)=>t()!=null?t()(e(n).finished):null,bt=p('<i class="bi bi-check-square-fill svelte-1jf04s4"></i>'),yt=p('<i class="bi bi-check-square svelte-1jf04s4"></i>'),gt=p('<div class="center-hz todo-item svelte-1jf04s4"><input type="checkbox" class="btn-check svelte-1jf04s4" autocomplete="off"> <label class="btn btn-outline svelte-1jf04s4" style="border: none;"><!></label> <input class="todo-name svelte-1jf04s4" aria-label="Todo name"></div>'),kt=(r,t,n)=>{t(e(n).length-1)},wt=p('<div class="center-vt todo-list svelte-1jf04s4"><h3 style="color: white; margin: 0px;" class="svelte-1jf04s4">Task List</h3> <!> <div class="center-hz todo-item mt-3 svelte-1jf04s4"><button class="btn btn-secondary svelte-1jf04s4">Add Task</button></div></div>');function jt(r,t){ee(t,!0);let n=K(t,"onFinish",3,void 0);function l(s,c,g=null){{let k=localStorage.getItem(s);k&&(c=JSON.parse(k))}return c}let a=z(F(l("todos",[{name:"",finished:!1}])));me(()=>{localStorage.setItem("todos",JSON.stringify(e(a)))});function i(s){return`todo-item-${Math.min(Math.max(0,s),e(a).length-1)}-input`}function v(s){h(a,F([...e(a).slice(0,s+1),{id:Date.now(),name:"",finished:!1},...e(a).slice(s+1)])),ye().then(()=>{document.getElementById(i(s+1)).focus()})}function m(s,c){var g,k;console.log(s.key),s.key=="Enter"&&e(a)[c].name!=""?(s.preventDefault(),v(c)):(s.key=="Backspace"||s.key=="Delete")&&e(a)[c].name==""&&e(a).length>1?(s.preventDefault(),h(a,F([...e(a).slice(0,c),...e(a).slice(c+1)])),ye().then(()=>{var T;(T=document.getElementById(i(c-1)))==null||T.focus()})):s.key=="ArrowUp"?(g=document.getElementById(i(c-1)))==null||g.focus():s.key=="ArrowDown"&&((k=document.getElementById(i(c+1)))==null||k.focus())}var y=wt(),o=j(f(y),2);pe(o,17,()=>e(a),Se,(s,c,g)=>{var k=gt(),T=f(k);le(T),q(T,"id",`todo-btn-${g??""}`),T.__change=[_t,n,c];var A=j(T,2);q(A,"for",`todo-btn-${g??""}`);var D=f(A);{var U=d=>{var B=bt();w(d,B)},E=d=>{var B=yt();w(d,B)};H(D,d=>{e(c).finished?d(U):d(E,!1)})}u(A);var I=j(A,2);le(I),q(I,"id",`todo-item-${g}-input`),I.__keydown=d=>m(d,g),u(k),L(()=>Q(k,"finished",e(c).finished)),$e(T,()=>e(c).finished,d=>e(c).finished=d),De(I,()=>e(c).name,d=>e(c).name=d),w(s,k)});var _=j(o,2),S=f(_);S.__click=[kt,v,a],u(_),u(y),w(r,y),te()}Ie(["change","keydown","click"]);class ue{constructor({name:t,length:n,color:l,reward:a,hasTask:i=!1}){this.name=t,this.length=n,this.color=l,this.reward=a,this.hasTask=i}calcScore(t,n){let l=5;if(t<.5)return 0;let a=t>n?Math.min(1,n/this.length):t<this.length?t/this.length:1,i=t>n?Math.pow((t-n)/l,2):0;return Math.max(0,Math.round((a-i)*this.reward))}}var pt=p('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-jjju7w"> </label>',1),St=p('<br> <br>  <div class="menu-bar mb-3 svelte-jjju7w"><div></div> <div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> <!></div> <div class="blocky-container mt-5 svelte-jjju7w"><div class="svelte-jjju7w"></div> <div style="margin-bottom: 70px;" class="svelte-jjju7w"><!></div> <div class="center-hz svelte-jjju7w"><div><!></div></div></div>',1);function Nt(r,t){ee(t,!0);const n=[],l={work:new ue({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new ue({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new ue({name:"Long Break",length:10,color:"#237047",reward:450})};let a=z("work"),i=0;function v(E,I){{let d=parseInt(localStorage.getItem("points"));d&&(I=parseInt(d))}return I}let m=z(F(v("points",0)));me(()=>{localStorage.setItem("points",e(m))});function y(E,I,d){h(m,e(m)+I),d&&(e(a)=="work"?(i+=E,i>=l.work.length*3.4?(i=0,h(a,"longbreak")):h(a,"break")):h(a,"work"))}function o(E){h(m,e(m)+200*(E?1:-1))}var _=St(),S=j(ne(_),4),s=j(f(S),2);pe(s,21,()=>Object.entries(l),Se,(E,I)=>{let d=()=>e(I)[0],B=()=>e(I)[1];var C=pt(),N=ne(C);le(N);var W,R=j(N,2),ae=f(R,!0);u(R),L(()=>{q(N,"id",`radio-${d()}`),W!==(W=d())&&(N.value=(N.__value=d())==null?"":d()),q(R,"for",`radio-${d()}`),q(R,"style",e(a)==d()?`background-color: ${B().color};`:""),$(ae,B().name)}),Ye(n,[],N,()=>(d(),e(a)),ie=>h(a,ie)),w(E,C)}),u(s);var c=j(s,2);Ee(c,{get amount(){return e(m)}}),u(S);var g=j(S,2),k=j(f(g),2),T=f(k);Te(T,()=>e(a),E=>{ht(E,{get mode(){return l[e(a)]},onFinish:y})}),u(k);var A=j(k,2),D=f(A),U=f(D);jt(U,{onFinish:o}),u(D),u(A),u(g),w(r,_),te()}export{Nt as component};
