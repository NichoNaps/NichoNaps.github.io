import{a as w,t as p,c as Le}from"../chunks/DP2vqTBw.js";import{aH as we,aI as Oe,aJ as qe,m as Ce,w as Y,F as Je,M as Ue,o as Re,x as Ve,aa as Ge,e as je,aE as fe,au as Ke,O as _e,p as ee,c as f,r as u,t as L,a as te,f as ne,ac as M,b as me,s as j,h as e,a8 as h,k as F,aK as be,aL as He,aG as ye}from"../chunks/DfUpMBoN.js";import{l as he,s as $,d as pe,e as ge,a as Qe}from"../chunks/D3ScgSNQ.js";import{e as Se,i as Ie}from"../chunks/CBcaEkv2.js";import{s as O,r as le}from"../chunks/CWgSzuDm.js";import{i as We,p as P}from"../chunks/DntXIJnS.js";import{p as G,i as H}from"../chunks/D-4SVFHf.js";import{t as Q}from"../chunks/Bvena8yX.js";import{a as Xe}from"../chunks/xhp2iC6K.js";import{s as Ze}from"../chunks/BqVvN_qU.js";function Te(r,t,n){Y&&Je();var l=r,a=Ge,s,v=we()?Oe:qe;Ce(()=>{v(a,a=t())&&(s&&Ue(s),s=Re(()=>n(l)))}),Y&&(l=Ve)}function Ee(r,t,n=t){var l=we();he(r,"input",a=>{var s=a?r.defaultValue:r.value;if(s=ce(r)?de(s):s,n(s),l&&s!==(s=t())){var v=r.selectionStart,m=r.selectionEnd;r.value=s??"",m!==null&&(r.selectionStart=v,r.selectionEnd=Math.min(m,r.value.length))}}),(Y&&r.defaultValue!==r.value||je(t)==null&&r.value)&&n(ce(r)?de(r.value):r.value),fe(()=>{var a=t();ce(r)&&a===de(r.value)||r.type==="date"&&!a&&!r.value||a!==r.value&&(r.value=a??"")})}const ve=new Set;function Ye(r,t,n,l,a=l){var s=n.getAttribute("type")==="checkbox",v=r;let m=!1;if(t!==null)for(var y of t)v=v[y]??(v[y]=[]);v.push(n),he(n,"change",()=>{var o=n.__value;s&&(o=ke(v,o,n.checked)),a(o)},()=>a(s?[]:null)),fe(()=>{var o=l();if(Y&&n.defaultChecked!==n.checked){m=!0;return}s?(o=o||[],n.checked=o.includes(n.__value)):n.checked=We(n.__value,o)}),Ke(()=>{var o=v.indexOf(n);o!==-1&&v.splice(o,1)}),ve.has(v)||(ve.add(v),_e(()=>{v.sort((o,_)=>o.compareDocumentPosition(_)===4?-1:1),ve.delete(v)})),_e(()=>{if(m){var o;if(s)o=ke(v,o,n.checked);else{var _=v.find(S=>S.checked);o=_==null?void 0:_.__value}a(o)}})}function $e(r,t,n=t){he(r,"change",l=>{var a=l?r.defaultChecked:r.checked;n(a)}),(Y&&r.defaultChecked!==r.checked||je(t)==null)&&n(r.checked),fe(()=>{var l=t();r.checked=!!l})}function ke(r,t,n){for(var l=new Set,a=0;a<r.length;a+=1)r[a].checked&&l.add(r[a].__value);return n||l.delete(t),Array.from(l)}function ce(r){var t=r.type;return t==="number"||t==="range"}function de(r){return r===""?null:+r}var et=p('<div><div class="backing svelte-efxvsm"><div><!></div></div></div>');function tt(r,t){ee(t,!0);let n=G(t,"borderRadius",3,"10px"),l=G(t,"progress",7,0),a=G(t,"color",3,"rgb(153, 86, 86)"),s=G(t,"extraPadding",3,"18px"),v=G(t,"style",3,"");l(Math.max(1,l()));var m=et(),y=f(m),o=f(y),_=f(o);{var S=i=>{var c=Le(),g=ne(c);Ze(g,()=>t.children),w(i,c)};H(_,i=>{t.children&&i(S)})}u(o),u(y),u(m),L(()=>{O(m,"style",`aspect-ratio: 1/1; display: inline-block; ${v()??""}`),O(y,"style",`--ring-width: ${n()??""}; --progress: ${l()??""}%; --ring-color: ${a()??""}; --extra-padding: ${s()??""};`)}),w(r,m),te()}var at=p('<span class="points-change svelte-15n4znc"> </span>'),rt=p('<!> <span class="points svelte-15n4znc"> </span>',1),nt=p('<span class="point-view svelte-15n4znc">ðŸª™ <!></span>');function xe(r,t){ee(t,!0);let n=t.amount==null,l=M(0),a=M(P(t.amount));me(()=>{t.amount!=e(a)&&(h(l,t.amount-e(a)),h(a,P(t.amount)))});var s=nt(),v=j(f(s));Te(v,()=>t.amount,m=>{var y=rt(),o=ne(y);{var _=c=>{var g=at(),k=f(g);u(g),L(T=>{O(g,"style",`color: ${(e(l)>=0?"#0F0":"#F00")??""};`),$(k,`${(e(l)>0?"+":"-")??""}${T??""}`)},[()=>Math.abs(e(l))]),w(c,g)};H(o,c=>{e(l)!=0&&c(_)})}var S=j(o,2),i=f(S,!0);u(S),L(()=>$(i,t.amount)),w(m,y)}),u(s),L(()=>{Q(s,"hide-first",n),Q(s,"hide-first-reveal",t.amount!=null&&n)}),w(r,s),te()}var lt=(r,t)=>confirm("Quit timer without cashing out?")?t(!0,!1):null,st=p('<button class="btn btn-danger svelte-vyjiyu" aria-label="resume"><i class="bi bi-play-fill svelte-vyjiyu"></i></button>'),it=p('<button class="btn btn-outline svelte-vyjiyu" aria-label="pause"><i class="bi bi-pause-fill svelte-vyjiyu"></i></button>'),ot=p('<div class="center-hz svelte-vyjiyu"><button class="btn btn-outline svelte-vyjiyu" aria-label="quit timer without cashing out points"><i class="bi bi-x-circle svelte-vyjiyu"></i></button> <!></div>'),vt=p('<div class="center-hz svelte-vyjiyu"><input class="form-control svelte-vyjiyu" type="number" style="width: 50%;" min="1" max="50"></div>'),ct=p('<div class="svelte-vyjiyu"><div class="center-hz svelte-vyjiyu" style="color: #bbbE;"> </div> <div class="timer-text center-hz svelte-vyjiyu"> </div> <!></div>'),dt=(r,t)=>t(!1,!0),ut=p('<button id="cashout-btn" class="btn btn-secondary btn-lg svelte-vyjiyu">Cash Out <!></button>'),ft=p('<button class="btn btn-primary btn-lg svelte-vyjiyu">Start</button>'),mt=p('<div class="center-hz svelte-vyjiyu"><div class="center-vt svelte-vyjiyu" style="width: 100%;"><div class="appear svelte-vyjiyu"><!> <div class="center-hz mt-4 svelte-vyjiyu"><!></div></div></div></div>');function ht(r,t){ee(t,!0);let n=G(t,"onFinish",3,void 0),l=M(!1),a=M(!1),s=M(P(t.mode.length)),v=F(()=>e(s)*60),m=M(P(new Date)),y=M(void 0),o=M(0),_=M(0),S=F(()=>e(o)+e(_)),i=F(()=>e(v)-e(S)),c=F(()=>Math.floor(Math.abs(e(i))/60)%60),g=F(()=>Math.round(Math.abs(e(i)))%60),k=F(()=>`${e(c).toString().padStart(2,"0")}:${e(g).toString().padStart(2,"0")}`),T=F(()=>new Date(e(m).getTime()+(e(v)-e(_))*1e3)),A=F(()=>Math.min(100,Math.round(e(S)/e(v)*100))),E=[10,5,2,1,0];for(;E[0]>=t.mode.length;)E=E.slice(1);function U(b,D,z="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let C={body:D,img:""};z!=null&&(C.tag=z),new Notification(b,C)}}function x(){h(o,(new Date-e(m))/1e3),e(i)<E[0]*60?(e(i)<0&&E[0]==0?U("Pomodoro","Finished. Good job!"):U("Pomodoro",`${E[0]} minutes remaining.`),E=E.slice(1)):e(i)<0&&E.length==0&&Math.abs(Math.abs(e(i))%60-30)<.6&&U("Pomodoro",`Overtime by ${(Math.abs(e(i))%60).toFixed(1)} minutes.`)}function I(){Notification.requestPermission().then(b=>{}),h(l,!0),h(a,!1),e(o)!=0&&(h(_,e(_)+e(o)),h(o,0)),h(m,P(new Date)),x(),h(y,P(setInterval(x,1e3)))}function d(b=!1,D=!1){let z=e(S)/60;n()(z,b?0:t.mode.calcScore(z,e(s)),D),h(l,!1),h(a,!1),clearInterval(e(y)),h(o,0),h(_,0)}function N(){h(a,!0),clearInterval(e(y))}Xe(()=>{e(l)&&d(!1,!1)});var q=mt();ge("keydown",be,b=>{b.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),e(l)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&b.key==" "&&(e(a)?I():N(),b.preventDefault())}),ge("beforeunload",be,b=>{e(l)&&(b.preventDefault(),b.returnValue=!0)}),Qe(b=>{L(()=>He.title=`${(e(l)?`${e(k)} - `:"")??""}pomodoro`)});var B=f(q),W=f(B),R=f(W);tt(R,{get progress(){return e(A)},get color(){return t.mode.color},style:"width: 100%;",children:(b,D)=>{var z=ct(),C=f(z),ie=f(C,!0);u(C);var re=j(C,2),ze=f(re,!0);u(re);var Fe=j(re,2);{var Pe=J=>{var V=ot(),X=f(V);X.__click=[lt,d];var oe=j(X,2);{var Ne=K=>{var Z=st();Z.__click=I,w(K,Z)},Be=K=>{var Z=it();Z.__click=N,w(K,Z)};H(oe,K=>{e(a)?K(Ne):K(Be,!1)})}u(V),w(J,V)},Ae=J=>{var V=vt(),X=f(V);le(X),u(V),Ee(X,()=>e(s),oe=>h(s,oe)),w(J,V)};H(Fe,J=>{e(l)?J(Pe):J(Ae,!1)})}u(z),L(J=>{$(ie,J),Q(re,"paused",e(a)),$(ze,e(k))},[()=>e(T).toLocaleTimeString()]),w(b,z)},$$slots:{default:!0}});var ae=j(R,2),se=f(ae);{var De=b=>{var D=ut();D.__click=[dt,d];var z=j(f(D));const C=F(()=>t.mode.calcScore(e(S)/60,e(s)));var ie=F(()=>e(C));xe(z,{get amount(){return e(ie)}}),u(D),w(b,D)},Me=b=>{var D=ft();D.__click=I,w(b,D)};H(se,b=>{e(l)?b(De):b(Me,!1)})}u(ae),u(W),u(B),u(q),L(()=>{Q(q,"overDone",e(i)<0),Q(q,"almostDone",e(i)<60)}),w(r,q),te()}pe(["click"]);var _t=(r,t,n)=>t()!=null?t()(e(n).finished):null,bt=p('<i class="bi bi-check-square-fill svelte-1jf04s4"></i>'),yt=p('<i class="bi bi-check-square svelte-1jf04s4"></i>'),gt=p('<div class="center-hz todo-item svelte-1jf04s4"><input type="checkbox" class="btn-check svelte-1jf04s4" autocomplete="off"> <label class="btn btn-outline svelte-1jf04s4" style="border: none;"><!></label> <input class="todo-name svelte-1jf04s4" aria-label="Todo name"></div>'),kt=(r,t,n)=>{t(e(n).length-1)},wt=p('<div class="center-vt todo-list svelte-1jf04s4"><h3 style="color: white; margin: 0px;" class="svelte-1jf04s4">Task List</h3> <!> <div class="center-hz todo-item mt-3 svelte-1jf04s4"><button class="btn btn-secondary svelte-1jf04s4">Add Task</button></div></div>');function jt(r,t){ee(t,!0);let n=G(t,"onFinish",3,void 0);function l(i,c,g=null){{let k=localStorage.getItem(i);k&&(c=JSON.parse(k))}return c}let a=M(P(l("todos",[{name:"",finished:!1}])));me(()=>{localStorage.setItem("todos",JSON.stringify(e(a)))});function s(i){return`todo-item-${Math.min(Math.max(0,i),e(a).length-1)}-input`}function v(i){h(a,P([...e(a).slice(0,i+1),{id:Date.now(),name:"",finished:!1},...e(a).slice(i+1)])),ye().then(()=>{document.getElementById(s(i+1)).focus()})}function m(i,c){var g,k;console.log(i.key),i.key=="Enter"&&e(a)[c].name!=""?(i.preventDefault(),v(c)):(i.key=="Backspace"||i.key=="Delete")&&e(a)[c].name==""&&e(a).length>1?(i.preventDefault(),h(a,P([...e(a).slice(0,c),...e(a).slice(c+1)])),ye().then(()=>{var T;(T=document.getElementById(s(c-1)))==null||T.focus()})):i.key=="ArrowUp"?(g=document.getElementById(s(c-1)))==null||g.focus():i.key=="ArrowDown"&&((k=document.getElementById(s(c+1)))==null||k.focus())}var y=wt(),o=j(f(y),2);Se(o,17,()=>e(a),Ie,(i,c,g)=>{var k=gt(),T=f(k);le(T),O(T,"id",`todo-btn-${g??""}`),T.__change=[_t,n,c];var A=j(T,2);O(A,"for",`todo-btn-${g??""}`);var E=f(A);{var U=d=>{var N=bt();w(d,N)},x=d=>{var N=yt();w(d,N)};H(E,d=>{e(c).finished?d(U):d(x,!1)})}u(A);var I=j(A,2);le(I),O(I,"id",`todo-item-${g}-input`),I.__keydown=d=>m(d,g),u(k),L(()=>Q(k,"finished",e(c).finished)),$e(T,()=>e(c).finished,d=>e(c).finished=d),Ee(I,()=>e(c).name,d=>e(c).name=d),w(i,k)});var _=j(o,2),S=f(_);S.__click=[kt,v,a],u(_),u(y),w(r,y),te()}pe(["change","keydown","click"]);class ue{constructor({name:t,length:n,color:l,reward:a,hasTask:s=!1}){this.name=t,this.length=n,this.color=l,this.reward=a,this.hasTask=s}calcScore(t,n){let l=5;if(t<.5)return 0;let a=t>n?Math.min(1,n/this.length):t<this.length?t/this.length:1,s=t>n?Math.pow((t-n)/l,2):0;return Math.max(0,Math.round((a-s)*this.reward))}}var pt=p('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-jjju7w"> </label>',1),St=p('<br> <br>  <div class="menu-bar mb-3 svelte-jjju7w"><div></div> <div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> <!></div> <div class="blocky-container mt-5 svelte-jjju7w"><div class="svelte-jjju7w"></div> <div style="margin-bottom: 70px;" class="svelte-jjju7w"><!></div> <div class="center-hz svelte-jjju7w"><div><!></div></div></div>',1);function Nt(r,t){ee(t,!0);const n=[],l={work:new ue({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new ue({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new ue({name:"Long Break",length:10,color:"#237047",reward:450})};let a=M("work"),s=0;function v(x,I){{let d=parseInt(localStorage.getItem("points"));d&&(I=parseInt(d))}return I}let m=M(P(v("points",0)));me(()=>{localStorage.setItem("points",e(m))});function y(x,I,d){h(m,e(m)+I),d&&(e(a)=="work"?(s+=x,s>=l.work.length*3.4?(s=0,h(a,"longbreak")):h(a,"break")):h(a,"work"))}function o(x){h(m,e(m)+200*(x?1:-1))}var _=St(),S=j(ne(_),4),i=j(f(S),2);Se(i,21,()=>Object.entries(l),Ie,(x,I)=>{let d=()=>e(I)[0],N=()=>e(I)[1];var q=pt(),B=ne(q);le(B);var W,R=j(B,2),ae=f(R,!0);u(R),L(()=>{O(B,"id",`radio-${d()}`),W!==(W=d())&&(B.value=(B.__value=d())==null?"":d()),O(R,"for",`radio-${d()}`),O(R,"style",e(a)==d()?`background-color: ${N().color};`:""),$(ae,N().name)}),Ye(n,[],B,()=>(d(),e(a)),se=>h(a,se)),w(x,q)}),u(i);var c=j(i,2);xe(c,{get amount(){return e(m)}}),u(S);var g=j(S,2),k=j(f(g),2),T=f(k);Te(T,()=>e(a),x=>{ht(x,{get mode(){return l[e(a)]},onFinish:y})}),u(k);var A=j(k,2),E=f(A),U=f(E);jt(U,{onFinish:o}),u(E),u(A),u(g),w(r,_),te()}export{Nt as component};
