import{a as k,t as b,c as Re}from"../chunks/D8IZ5tij.js";import{aH as Te,aI as Ue,aJ as je,o as Ge,x as se,G as Ve,N as We,q as He,y as Je,aa as Ke,aE as Ie,au as Xe,P as ye,g as Ze,p as oe,c,r as v,t as D,a as ne,f as le,ac as I,b as Ee,s as h,i as e,a8 as d,aK as Qe,aL as Ye,l as A}from"../chunks/DRP5GfAB.js";import{l as Me,s as H,d as $e,e as ea,a as aa}from"../chunks/DcfRItNb.js";import{e as ta,i as ra}from"../chunks/Duy6D2ej.js";import{s as J,r as be}from"../chunks/KYYcMl7V.js";import{i as sa,p as O}from"../chunks/DlRuioKL.js";import{p as G,i as j}from"../chunks/kFZv4Qm8.js";import{t as Q}from"../chunks/Bvena8yX.js";import{r as la}from"../chunks/BfgKyPlE.js";import{a as oa}from"../chunks/xSQF6w4t.js";import{s as na}from"../chunks/DzRVWYVD.js";function Fe(t,a,s){se&&Ve();var n=t,o=Ke,r,l=Te()?Ue:je;Ge(()=>{l(o,o=a())&&(r&&We(r),r=He(()=>s(n)))}),se&&(n=Je)}function fe(t,a,s=a){var n=Te();Me(t,"input",o=>{var r=o?t.defaultValue:t.value;if(r=he(t)?_e(r):r,s(r),n&&r!==(r=a())){var l=t.selectionStart,_=t.selectionEnd;t.value=r??"",_!==null&&(t.selectionStart=l,t.selectionEnd=Math.min(_,t.value.length))}}),(se&&t.defaultValue!==t.value||Ze(a)==null&&t.value)&&s(he(t)?_e(t.value):t.value),Ie(()=>{var o=a();he(t)&&o===_e(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}const me=new Set;function ia(t,a,s,n,o=n){var r=s.getAttribute("type")==="checkbox",l=t;let _=!1;if(a!==null)for(var u of a)l=l[u]??(l[u]=[]);l.push(s),Me(s,"change",()=>{var i=s.__value;r&&(i=Se(l,i,s.checked)),o(i)},()=>o(r?[]:null)),Ie(()=>{var i=n();if(se&&s.defaultChecked!==s.checked){_=!0;return}r?(i=i||[],s.checked=i.includes(s.__value)):s.checked=sa(s.__value,i)}),Xe(()=>{var i=l.indexOf(s);i!==-1&&l.splice(i,1)}),me.has(l)||(me.add(l),ye(()=>{l.sort((i,g)=>i.compareDocumentPosition(g)===4?-1:1),me.delete(l)})),ye(()=>{if(_){var i;if(r)i=Se(l,i,s.checked);else{var g=l.find(f=>f.checked);i=g==null?void 0:g.__value}o(i)}})}function Se(t,a,s){for(var n=new Set,o=0;o<t.length;o+=1)t[o].checked&&n.add(t[o].__value);return s||n.delete(a),Array.from(n)}function he(t){var a=t.type;return a==="number"||a==="range"}function _e(t){return t===""?null:+t}var va=b('<div style="aspect-ratio: 1/1; display: inline-block;"><div class="backing svelte-efxvsm"><div><!></div></div></div>');function ca(t,a){oe(a,!0);let s=G(a,"borderRadius",3,"10px"),n=G(a,"progress",7,0),o=G(a,"color",3,"rgb(153, 86, 86)"),r=G(a,"extraPadding",3,"18px");n(Math.max(1,n()));var l=va(),_=c(l),u=c(_),i=c(u);{var g=f=>{var x=Re(),p=le(x);na(p,()=>a.children),k(f,x)};j(i,f=>{a.children&&f(g)})}v(u),v(_),v(l),D(()=>J(_,"style",`--ring-width: ${s()??""}; --progress: ${n()??""}%; --ring-color: ${o()??""}; --extra-padding: ${r()??""};`)),k(t,l),ne()}var da=b('<span class="points-change svelte-1wqisxr"> </span>'),ua=b('<!> <span class="points svelte-1wqisxr"> </span>',1),fa=b('<span class="point-view svelte-1wqisxr">ðŸª™ <!></span>');function Ne(t,a){oe(a,!0);let s=a.amount==null,n=I(0),o=I(O(a.amount));Ee(()=>{a.amount!=e(o)&&(d(n,a.amount-e(o)),d(o,O(a.amount)))});var r=fa(),l=h(c(r));Fe(l,()=>a.amount,_=>{var u=ua(),i=le(u);{var g=p=>{var w=da(),V=c(w);v(w),D(y=>{J(w,"style",`color: ${(e(n)>=0?"#0F0":"#F00")??""};`),H(V,`${(e(n)>0?"+":"-")??""}${y??""}`)},[()=>Math.abs(e(n))]),k(p,w)};j(i,p=>{e(n)!=0&&p(g)})}var f=h(i,2),x=c(f,!0);v(f),D(()=>H(x,a.amount)),k(_,u)}),v(r),D(()=>{Q(r,"hide-first",s),Q(r,"hide-first-reveal",a.amount!=null&&s)}),k(t,r),ne()}var ma=b('<textarea id="timer-name-edit" class="svelte-x0aupk"></textarea>'),ha=b('<span style="font-style: italic; color: #bbbE;" class="svelte-x0aupk"> </span>'),_a=b('<div class="svelte-x0aupk"><div class="center-hz svelte-x0aupk" style="color: #bbbE;"> </div> <h1 class="timer-text center-hz svelte-x0aupk"> </h1> <div class="timer-task center-vt svelte-x0aupk"><div class="center-hz svelte-x0aupk"><!></div></div></div>'),ka=(t,a)=>a(!0),ba=b('<button class="btn btn-secondary svelte-x0aupk" aria-label="finish current task"><i class="bi bi-check-circle svelte-x0aupk"></i></button>'),ga=b('<button class="btn btn-danger svelte-x0aupk" aria-label="resume"><i class="bi bi-play-fill svelte-x0aupk"></i></button>'),xa=b('<button class="btn btn-secondary svelte-x0aupk" aria-label="pause"><i class="bi bi-pause-fill svelte-x0aupk"></i></button>'),pa=b('<div class="appear svelte-x0aupk"><!> <div class="timer-btns center-hz appear mt-3 svelte-x0aupk"><button id="cashout-btn" class="btn btn-secondary svelte-x0aupk">Cash Out <!></button> <!> <!></div></div>'),wa=b('<div class="form-group svelte-x0aupk"><label class="svelte-x0aupk">What would you like to work on? <input class="form-control svelte-x0aupk" placeholder="Set task name"></label></div>'),ya=b('<div class="center-vt svelte-x0aupk"><div class="form-group svelte-x0aupk"><label class="svelte-x0aupk">Duration: <input class="form-control svelte-x0aupk" type="number" min="1" max="50"></label></div> <!> <button class="btn btn-primary mt-4 svelte-x0aupk">Start</button></div>'),Sa=b('<div class="center-hz svelte-x0aupk"><div class="center-vt svelte-x0aupk"><div class="center-hz svelte-x0aupk"></div> <div class="center-hz svelte-x0aupk"><!></div></div></div>');function Ta(t,a){oe(a,!0);let s=G(a,"taskName",15,void 0),n=G(a,"onFinish",3,void 0),o=G(a,"onTaskFinish",3,void 0),r=I(!1),l=I(!1),_=I(O(a.mode.length)),u=A(()=>e(_)*60),i=I(O(new Date)),g=I(void 0),f=I(0),x=I(0),p=A(()=>e(f)+e(x)),w=A(()=>e(u)-e(p)),V=A(()=>Math.floor(Math.abs(e(w))/60)%60),y=A(()=>Math.round(Math.abs(e(w)))%60),E=A(()=>new Date(e(i).getTime()+(e(u)-e(x))*1e3)),S=A(()=>Math.min(100,Math.round(e(p)/e(u)*100))),N=[10,5,2,1,0];for(;N[0]>=a.mode.length;)N=N.slice(1);function K(m,M,F="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let L={body:M,img:""};F!=null&&(L.tag=F),new Notification(m,L)}}function q(){d(f,(new Date-e(i))/1e3),e(w)<N[0]*60&&(e(w)<0&&N[0]==0?K("Pomodoro","Finished. Good job!"):K("Pomodoro",`${(e(w)/60).toFixed(2)} minutes remaining.`),N=N.slice(1))}function W(){Notification.requestPermission().then(m=>{}),d(r,!0),d(l,!1),e(f)!=0&&(d(x,e(x)+e(f)),d(f,0)),d(i,O(new Date)),q(),d(g,O(setInterval(q,1e3)))}function R(m=!1){n()(e(p)/60,m),d(r,!1),d(l,!1),clearInterval(e(g)),d(f,0),d(x,0)}function Y(){d(l,!0),clearInterval(e(g))}oa(()=>{e(r)&&R(!1)});function $(){o()(s()),document.getElementById("timer-name-edit").select()}var X=Sa();ea("keydown",Qe,m=>{m.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),e(r)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&(m.key==" "?(e(l)?W():Y(),m.preventDefault()):m.key=="f"&&s()!=null&&confirm("Finish task: "+s())&&($(),m.preventDefault()))}),aa(m=>{D((M,F)=>Ye.title=`${M??""}:${F??""} - Pomodoro`,[()=>e(V).toString().padStart(2,"0"),()=>e(y).toString().padStart(2,"0")])});var ge=c(X),xe=h(c(ge),2),Pe=c(xe);{var De=m=>{var M=pa(),F=c(M);ca(F,{get progress(){return e(S)},get color(){return a.mode.color},children:(T,z)=>{var ce=_a(),de=c(ce),Ae=c(de,!0);v(de);var re=h(de,2),Le=c(re);v(re);var pe=h(re,2),we=c(pe),Ce=c(we);{var Be=B=>{var P=ma();la(P),D(()=>J(P,"placeholder",a.mode.name)),fe(P,s),k(B,P)},Oe=B=>{var P=ha(),ue=c(P,!0);v(P),D(()=>H(ue,a.mode.name)),k(B,P)};j(Ce,B=>{a.mode.hasTask?B(Be):B(Oe,!1)})}v(we),v(pe),v(ce),D((B,P,ue)=>{H(Ae,B),Q(re,"paused",e(l)),H(Le,`${P??""}:${ue??""}`)},[()=>e(E).toLocaleTimeString(),()=>e(V).toString().padStart(2,"0"),()=>e(y).toString().padStart(2,"0")]),k(T,ce)},$$slots:{default:!0}});var L=h(F,2),U=c(L);U.__click=[ka,R];var ee=h(c(U));const ie=A(()=>a.mode.calcScore(e(p)/60));var ve=A(()=>e(ie));Ne(ee,{get amount(){return e(ve)}}),v(U);var C=h(U,2);{var Z=T=>{var z=ba();z.__click=$,k(T,z)};j(C,T=>{a.mode.hasTask&&T(Z)})}var ae=h(C,2);{var te=T=>{var z=ga();z.__click=W,k(T,z)},ze=T=>{var z=xa();z.__click=Y,k(T,z)};j(ae,T=>{e(l)?T(te):T(ze,!1)})}v(L),v(M),k(m,M)},qe=m=>{var M=ya(),F=c(M),L=c(F),U=h(c(L));be(U),v(L),v(F);var ee=h(F,2);{var ie=C=>{var Z=wa(),ae=c(Z),te=h(c(ae));be(te),v(ae),v(Z),fe(te,s),k(C,Z)};j(ee,C=>{a.mode.hasTask&&C(ie)})}var ve=h(ee,2);ve.__click=W,v(M),fe(U,()=>e(_),C=>d(_,C)),k(m,M)};j(Pe,m=>{e(r)?m(De):m(qe,!1)})}v(xe),v(ge),v(X),D(()=>{Q(X,"overDone",e(w)<0),Q(X,"almostDone",e(w)<60)}),k(t,X),ne()}$e(["click"]);class ke{constructor({name:a,length:s,color:n,reward:o,hasTask:r=!1}){this.name=a,this.length=s,this.color=n,this.reward=o,this.hasTask=r}calcScore(a){let s=10,n=5;if(a<1)return 0;let o=a>this.length?Math.pow((a-this.length)/n,2):0;return Math.max(0,Math.round((1/(1+Math.pow(Math.E,-((a-this.length/2)*(s/this.length))))-o)*this.reward))}}var Ia=b('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-1w7m3ok"> </label>',1),Ea=b('<br> <br>  <div class="menu-bar mb-3 svelte-1w7m3ok"><div></div> <div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> <!></div> <!>',1);function Oa(t,a){oe(a,!0);const s=[],n={work:new ke({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new ke({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new ke({name:"Long Break",length:10,color:"#237047",reward:450})};let o=I(""),r=I("work"),l=0;function _(y,E){{let S=parseInt(localStorage.getItem("points"));S&&(E=parseInt(S))}return E}let u=I(O(_("points",0)));Ee(()=>{localStorage.setItem("points",e(u))});function i(y,E){d(u,e(u)+n[e(r)].calcScore(y)),E&&(e(r)=="work"?(l+=y,l>=n.work.length*3.4?(l=0,d(r,"longbreak")):d(r,"break")):d(r,"work"))}function g(){d(u,e(u)+1e3)}var f=Ea(),x=h(le(f),4),p=h(c(x),2);ta(p,21,()=>Object.entries(n),ra,(y,E)=>{let S=()=>e(E)[0],N=()=>e(E)[1];var K=Ia(),q=le(K);be(q);var W,R=h(q,2),Y=c(R,!0);v(R),D(()=>{J(q,"id",`radio-${S()}`),W!==(W=S())&&(q.value=(q.__value=S())==null?"":S()),J(R,"for",`radio-${S()}`),J(R,"style",e(r)==S()?`background-color: ${N().color};`:""),H(Y,N().name)}),ia(s,[],q,()=>(S(),e(r)),$=>d(r,$)),k(y,K)}),v(p);var w=h(p,2);Ne(w,{get amount(){return e(u)}}),v(x);var V=h(x,2);Fe(V,()=>e(r),y=>{Ta(y,{get mode(){return n[e(r)]},onFinish:i,onTaskFinish:g,get taskName(){return e(o)},set taskName(E){d(o,O(E))}})}),k(t,f),ne()}export{Oa as component};
