import{a as y,t as w,c as we}from"../chunks/BCe9DMxx.js";import{aH as Se,aI as Re,aJ as Be,o as Oe,x as $,G as Ue,P as Ce,q as Ve,y as We,aa as Ge,aE as Te,au as He,R as ke,g as Je,p as Ee,c,r as n,t as U,a as Fe,f as Y,ac as P,aK as Ke,s as x,i as e,aL as Xe,l as B,a8 as f}from"../chunks/Cwxz4zsB.js";import{l as Ie,d as Ze,e as Qe,a as Ye,s as K}from"../chunks/D0_HKjy9.js";import{p as N,i as O,s as ye}from"../chunks/D_0EBigx.js";import{e as $e,i as ea}from"../chunks/BOdTrU8H.js";import{s as X,r as fe}from"../chunks/C9H9V2QD.js";import{i as aa,p as W}from"../chunks/BAXBLNLT.js";import{t as ta}from"../chunks/Bvena8yX.js";import{r as ra}from"../chunks/CGLGJUg4.js";import{a as ia}from"../chunks/BHrwyQfe.js";import{s as sa}from"../chunks/D9c0H0XM.js";function la(a,r,s){$&&Ue();var v=a,t=Ge,o,i=Se()?Re:Be;Oe(()=>{i(t,t=r())&&(o&&Ce(o),o=Ve(()=>s(v)))}),$&&(v=We)}function ne(a,r,s=r){var v=Se();Ie(a,"input",t=>{var o=t?a.defaultValue:a.value;if(o=ce(a)?de(o):o,s(o),v&&o!==(o=r())){var i=a.selectionStart,j=a.selectionEnd;a.value=o??"",j!==null&&(a.selectionStart=i,a.selectionEnd=Math.min(j,a.value.length))}}),($&&a.defaultValue!==a.value||Je(r)==null&&a.value)&&s(ce(a)?de(a.value):a.value),Te(()=>{var t=r();ce(a)&&t===de(a.value)||a.type==="date"&&!t&&!a.value||t!==a.value&&(a.value=t??"")})}const ve=new Set;function oa(a,r,s,v,t=v){var o=s.getAttribute("type")==="checkbox",i=a;let j=!1;if(r!==null)for(var _ of r)i=i[_]??(i[_]=[]);i.push(s),Ie(s,"change",()=>{var l=s.__value;o&&(l=je(i,l,s.checked)),t(l)},()=>t(o?[]:null)),Te(()=>{var l=v();if($&&s.defaultChecked!==s.checked){j=!0;return}o?(l=l||[],s.checked=l.includes(s.__value)):s.checked=aa(s.__value,l)}),He(()=>{var l=i.indexOf(s);l!==-1&&i.splice(l,1)}),ve.has(i)||(ve.add(i),ke(()=>{i.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),ve.delete(i)})),ke(()=>{if(j){var l;if(o)l=je(i,l,s.checked);else{var u=i.find(g=>g.checked);l=u==null?void 0:u.__value}t(l)}})}function je(a,r,s){for(var v=new Set,t=0;t<a.length;t+=1)a[t].checked&&v.add(a[t].__value);return s||v.delete(r),Array.from(v)}function ce(a){var r=a.type;return r==="number"||r==="range"}function de(a){return a===""?null:+a}var na=w('<div style="aspect-ratio: 1/1; display: inline-block;"><div class="backing svelte-efxvsm"><div><!></div></div></div>');function va(a,r){Ee(r,!0);let s=N(r,"borderRadius",3,"10px"),v=N(r,"progress",7,0),t=N(r,"color",3,"rgb(153, 86, 86)"),o=N(r,"extraPadding",3,"18px");v(Math.max(1,v()));var i=na(),j=c(i),_=c(j),l=c(_);{var u=g=>{var M=we(),L=Y(M);sa(L,()=>r.children),y(g,M)};O(l,g=>{r.children&&g(u)})}n(_),n(j),n(i),U(()=>X(j,"style",`--ring-width: ${s()??""}; --progress: ${v()??""}%; --ring-color: ${t()??""}; --extra-padding: ${o()??""};`)),y(a,i),Fe()}var ca=w('<textarea id="timer-name-edit" class="svelte-1ihjghp"></textarea>'),da=w('<span style="font-style: italic; color: #bbbE;" class="svelte-1ihjghp"> </span>'),fa=w('<div class="svelte-1ihjghp"><div class="center-hz svelte-1ihjghp" style="color: #bbbE;"> </div> <h1 class="timer-text center-hz svelte-1ihjghp"> </h1> <div class="timer-task center-vt svelte-1ihjghp"><div class="center-hz svelte-1ihjghp"><!></div></div></div>'),ha=w('<button class="btn btn-secondary svelte-1ihjghp" aria-label="finish current task"><i class="bi bi-check-circle svelte-1ihjghp"></i></button>'),ua=w('<button class="btn btn-danger svelte-1ihjghp" aria-label="resume"><i class="bi bi-play-fill svelte-1ihjghp"></i></button>'),ma=w('<button class="btn btn-secondary svelte-1ihjghp" aria-label="pause"><i class="bi bi-pause-fill svelte-1ihjghp"></i></button>'),_a=w('<div class="appear svelte-1ihjghp"><!> <div class="timer-btns center-hz appear mt-3 svelte-1ihjghp"><button class="btn btn-secondary svelte-1ihjghp" aria-label="quit timer early"><i class="bi bi-arrow-left svelte-1ihjghp"></i></button> <!> <!></div></div>'),ga=w('<div class="form-group svelte-1ihjghp"><label class="svelte-1ihjghp">What would you like to work on? <input class="form-control svelte-1ihjghp" placeholder="Set task name"></label></div>'),ba=w('<div class="center-vt svelte-1ihjghp"><div class="form-group svelte-1ihjghp"><label class="svelte-1ihjghp">Duration: <input class="form-control svelte-1ihjghp" type="number" min="1" max="50"></label></div> <!> <button class="btn btn-primary mt-4 svelte-1ihjghp">Start</button></div>'),pa=w('<div class="center-hz svelte-1ihjghp"><div class="center-vt svelte-1ihjghp"><div class="center-hz svelte-1ihjghp"></div> <div class="center-hz svelte-1ihjghp"><!></div></div></div>');function xe(a,r){Ee(r,!0);let s=N(r,"length",3,25),v=N(r,"name",3,"Untitled"),t=N(r,"taskName",15,void 0),o=N(r,"color",3,"#F00"),i=N(r,"onFinish",3,void 0),j=N(r,"onTaskFinish",3,void 0),_=P(!1),l=P(!1),u=P(W(s())),g=B(()=>e(u)*60),M=P(W(new Date)),L=P(void 0),b=P(0),h=P(0),p=B(()=>e(b)+e(h)),F=B(()=>Math.max(0,e(g)-e(p))),A=B(()=>Math.floor(e(F)/60)%60),m=B(()=>Math.round(e(F))%60),C=B(()=>new Date(e(M).getTime()+(e(g)-e(h))*1e3)),V=B(()=>Math.round(e(p)/e(g)*100)),D=[10,5,2,1];function Z(){let d=(new Date-e(M))/1e3;if(d>e(g))f(b,W(e(g))),ae(),he("Pomodoro","Out of time"),i()!=null;else{for(f(b,d);D[0]>=e(u);)D=D.slice(1);e(F)<D[0]*60&&(he("Pomodoro",`${(e(F)/60).toFixed(2)} minutes remaining.`),D=D.slice(1))}}function he(d,T,E="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let q={body:T,img:""};E!=null&&(q.tag=E),new Notification(d,q)}}function ee(){Notification.requestPermission().then(d=>{}),f(_,!0),f(l,!1),e(b)>0&&(f(h,e(h)+e(b)),f(b,0)),f(M,W(new Date)),Z(),f(L,W(setInterval(Z,1e3)))}function ae(){i()(e(p)/60),f(_,!1),f(l,!1),clearInterval(e(L)),f(b,0),f(h,0)}function ue(){f(l,!0),clearInterval(e(L))}ia(()=>{e(_)&&ae()});function me(){j()(t()),document.getElementById("timer-name-edit").select()}var te=pa();Qe("keydown",Ke,d=>{d.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),e(_)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&(d.key==" "?(e(l)?ee():ue(),d.preventDefault()):d.key=="f"&&t()!=null&&confirm("Finish task: "+t())&&(me(),d.preventDefault()))}),Ye(d=>{U((T,E)=>Xe.title=`${T??""}:${E??""} - Pomodoro`,[()=>e(A).toString().padStart(2,"0"),()=>e(m).toString().padStart(2,"0")])});var _e=c(te),ge=x(c(_e),2),Pe=c(ge);{var Ne=d=>{var T=_a(),E=c(T);va(E,{get progress(){return e(V)},get color(){return o()},children:(k,S)=>{var se=fa(),le=c(se),De=c(le,!0);n(le);var Q=x(le,2),qe=c(Q);n(Q);var be=x(Q,2),pe=c(be),ze=c(pe);{var Le=z=>{var I=ca();ra(I),U(()=>X(I,"placeholder",v())),ne(I,t),y(z,I)},Ae=z=>{var I=da(),oe=c(I,!0);n(I),U(()=>K(oe,v())),y(z,I)};O(ze,z=>{t()!==void 0?z(Le):z(Ae,!1)})}n(pe),n(be),n(se),U((z,I,oe)=>{K(De,z),ta(Q,"paused",e(l)),K(qe,`${I??""}:${oe??""}`)},[()=>e(C).toLocaleTimeString(),()=>e(A).toString().padStart(2,"0"),()=>e(m).toString().padStart(2,"0")]),y(k,se)},$$slots:{default:!0}});var q=x(E,2),G=c(q);G.__click=ae;var H=x(G,2);{var re=k=>{var S=ha();S.__click=me,y(k,S)};O(H,k=>{t()!==void 0&&k(re)})}var ie=x(H,2);{var R=k=>{var S=ua();S.__click=ee,y(k,S)},J=k=>{var S=ma();S.__click=ue,y(k,S)};O(ie,k=>{e(l)?k(R):k(J,!1)})}n(q),n(T),y(d,T)},Me=d=>{var T=ba(),E=c(T),q=c(E),G=x(c(q));fe(G),n(q),n(E);var H=x(E,2);{var re=R=>{var J=ga(),k=c(J),S=x(c(k));fe(S),n(k),n(J),ne(S,t),y(R,J)};O(H,R=>{t()!==void 0&&R(re)})}var ie=x(H,2);ie.__click=ee,n(T),ne(G,()=>e(u),R=>f(u,R)),y(d,T)};O(Pe,d=>{e(_)?d(Ne):d(Me,!1)})}n(ge),n(_e),n(te),y(a,te),Fe()}Ze(["click"]);var ka=w('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-12sfgq9"> </label>',1),ya=w('<br> <br>  <div class="center-hz mb-3 svelte-12sfgq9"><div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> </div> <!>',1);function Da(a){const r=[],s={work:{name:"Work",length:25,color:"#ab5744",reward:1e3},break:{name:"Break",length:5,color:"#4d82ab",reward:300},longbreak:{name:"Long Break",length:10,color:"#237047",reward:450}};let v=P(""),t=P("work");function o(b,h,p){return 1/(1+Math.pow(Math.E,-((b-h/2)*(10/h))))*p}let i=P(0);function j(b){let h=Math.round(o(b,s[e(t)].length,s[e(t)].reward));f(i,e(i)+h),console.log("Scored",h)}function _(){f(i,e(i)+1e3)}var l=ya(),u=x(Y(l),4),g=c(u);$e(g,21,()=>Object.entries(s),ea,(b,h)=>{let p=()=>e(h)[0],F=()=>e(h)[1];var A=ka(),m=Y(A);fe(m);var C,V=x(m,2),D=c(V,!0);n(V),U(()=>{X(m,"id",`radio-${p()}`),C!==(C=p())&&(m.value=(m.__value=p())==null?"":p()),X(V,"for",`radio-${p()}`),X(V,"style",e(t)==p()?`background-color: ${F().color};`:""),K(D,F().name)}),oa(r,[],m,()=>(p(),e(t)),Z=>f(t,Z)),y(b,A)}),n(g);var M=x(g);n(u);var L=x(u,2);la(L,()=>e(t),b=>{var h=we(),p=Y(h);{var F=m=>{xe(m,ye(()=>s[e(t)],{onFinish:j,onTaskFinish:_,get taskName(){return e(v)},set taskName(C){f(v,W(C))}}))},A=m=>{xe(m,ye(()=>s[e(t)],{onFinish:j,onTaskFinish:_}))};O(p,m=>{e(t)=="work"?m(F):m(A,!1)})}y(b,h)}),U(()=>K(M,` ${e(i)??""}pts`)),y(a,l)}export{Da as component};
