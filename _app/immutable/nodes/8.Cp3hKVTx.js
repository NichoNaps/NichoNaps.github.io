import{a as b,t as k,c as Re}from"../chunks/D8IZ5tij.js";import{aH as Se,aI as Ue,aJ as Ge,o as Ve,x as re,G as We,N as He,q as Je,y as Ke,aa as Qe,aE as Te,au as Xe,P as je,g as Ze,p as ne,c,r as v,t as P,a as oe,f as le,ac as p,b as pe,s as m,i as t,a8 as d,aK as Ye,aL as $e,l as z}from"../chunks/DRP5GfAB.js";import{l as Ie,s as H,d as et,e as tt,a as at}from"../chunks/DcfRItNb.js";import{e as st,i as rt}from"../chunks/Duy6D2ej.js";import{s as J,r as ke}from"../chunks/KYYcMl7V.js";import{i as lt,p as O}from"../chunks/DlRuioKL.js";import{p as G,i as U}from"../chunks/kFZv4Qm8.js";import{t as Y}from"../chunks/Bvena8yX.js";import{r as nt}from"../chunks/BfgKyPlE.js";import{a as ot}from"../chunks/xSQF6w4t.js";import{s as it}from"../chunks/DzRVWYVD.js";function Ee(a,e,r){re&&We();var o=a,n=Qe,s,l=Se()?Ue:Ge;Ve(()=>{l(n,n=e())&&(s&&He(s),s=Je(()=>r(o)))}),re&&(o=Ke)}function fe(a,e,r=e){var o=Se();Ie(a,"input",n=>{var s=n?a.defaultValue:a.value;if(s=_e(a)?he(s):s,r(s),o&&s!==(s=e())){var l=a.selectionStart,f=a.selectionEnd;a.value=s??"",f!==null&&(a.selectionStart=l,a.selectionEnd=Math.min(f,a.value.length))}}),(re&&a.defaultValue!==a.value||Ze(e)==null&&a.value)&&r(_e(a)?he(a.value):a.value),Te(()=>{var n=e();_e(a)&&n===he(a.value)||a.type==="date"&&!n&&!a.value||n!==a.value&&(a.value=n??"")})}const me=new Set;function vt(a,e,r,o,n=o){var s=r.getAttribute("type")==="checkbox",l=a;let f=!1;if(e!==null)for(var u of e)l=l[u]??(l[u]=[]);l.push(r),Ie(r,"change",()=>{var i=r.__value;s&&(i=xe(l,i,r.checked)),n(i)},()=>n(s?[]:null)),Te(()=>{var i=o();if(re&&r.defaultChecked!==r.checked){f=!0;return}s?(i=i||[],r.checked=i.includes(r.__value)):r.checked=lt(r.__value,i)}),Xe(()=>{var i=l.indexOf(r);i!==-1&&l.splice(i,1)}),me.has(l)||(me.add(l),je(()=>{l.sort((i,g)=>i.compareDocumentPosition(g)===4?-1:1),me.delete(l)})),je(()=>{if(f){var i;if(s)i=xe(l,i,r.checked);else{var g=l.find(_=>_.checked);i=g==null?void 0:g.__value}n(i)}})}function xe(a,e,r){for(var o=new Set,n=0;n<a.length;n+=1)a[n].checked&&o.add(a[n].__value);return r||o.delete(e),Array.from(o)}function _e(a){var e=a.type;return e==="number"||e==="range"}function he(a){return a===""?null:+a}var ct=k('<div style="aspect-ratio: 1/1; display: inline-block;"><div class="backing svelte-efxvsm"><div><!></div></div></div>');function dt(a,e){ne(e,!0);let r=G(e,"borderRadius",3,"10px"),o=G(e,"progress",7,0),n=G(e,"color",3,"rgb(153, 86, 86)"),s=G(e,"extraPadding",3,"18px");o(Math.max(1,o()));var l=ct(),f=c(l),u=c(f),i=c(u);{var g=_=>{var w=Re(),q=le(w);it(q,()=>e.children),b(_,w)};U(i,_=>{e.children&&_(g)})}v(u),v(f),v(l),P(()=>J(f,"style",`--ring-width: ${r()??""}; --progress: ${o()??""}%; --ring-color: ${n()??""}; --extra-padding: ${s()??""};`)),b(a,l),oe()}var ut=k('<span class="points-change svelte-1wqisxr"> </span>'),ft=k('<!> <span class="points svelte-1wqisxr"> </span>',1),mt=k('<span class="point-view svelte-1wqisxr">ðŸª™ <!></span>');function Fe(a,e){ne(e,!0);let r=e.amount==null,o=p(0),n=p(O(e.amount));pe(()=>{e.amount!=t(n)&&(d(o,e.amount-t(n)),d(n,O(e.amount)))});var s=mt(),l=m(c(s));Ee(l,()=>e.amount,f=>{var u=ft(),i=le(u);{var g=q=>{var y=ut(),V=c(y);v(y),P(I=>{J(y,"style",`color: ${(t(o)>=0?"#0F0":"#F00")??""};`),H(V,`${(t(o)>0?"+":"-")??""}${I??""}`)},[()=>Math.abs(t(o))]),b(q,y)};U(i,q=>{t(o)!=0&&q(g)})}var _=m(i,2),w=c(_,!0);v(_),P(()=>H(w,e.amount)),b(f,u)}),v(s),P(()=>{Y(s,"hide-first",r),Y(s,"hide-first-reveal",e.amount!=null&&r)}),b(a,s),oe()}var _t=k('<textarea id="timer-name-edit" class="svelte-1qw7jss"></textarea>'),ht=k('<span style="font-style: italic; color: #bbbE;" class="svelte-1qw7jss"> </span>'),bt=k('<div class="svelte-1qw7jss"><div class="center-hz svelte-1qw7jss" style="color: #bbbE;"> </div> <h1 class="timer-text center-hz svelte-1qw7jss"> </h1> <div class="timer-task center-vt svelte-1qw7jss"><div class="center-hz svelte-1qw7jss"><!></div></div></div>'),kt=(a,e)=>e(!1,!0),gt=k('<button class="btn btn-secondary svelte-1qw7jss" aria-label="finish current task"><i class="bi bi-check-circle svelte-1qw7jss"></i></button>'),wt=(a,e)=>confirm("Quit timer without cashing out?")?e(!0,!1):null,qt=k('<button class="btn btn-danger svelte-1qw7jss" aria-label="resume"><i class="bi bi-play-fill svelte-1qw7jss"></i></button>'),yt=k('<button class="btn btn-secondary svelte-1qw7jss" aria-label="pause"><i class="bi bi-pause-fill svelte-1qw7jss"></i></button>'),jt=k('<div class="appear svelte-1qw7jss"><!> <div class="timer-btns center-hz appear mt-3 svelte-1qw7jss"><button id="cashout-btn" class="btn btn-secondary svelte-1qw7jss">Cash Out <!></button> <!> <button class="btn btn-secondary svelte-1qw7jss" aria-label="quit timer without cashing out points"><i class="bi bi-x-circle svelte-1qw7jss"></i></button> <!></div></div>'),xt=k('<div class="form-group svelte-1qw7jss"><label class="svelte-1qw7jss">What would you like to work on? <input class="form-control svelte-1qw7jss" placeholder="Set task name"></label></div>'),St=k('<div class="center-vt svelte-1qw7jss"><div class="form-group svelte-1qw7jss"><label class="svelte-1qw7jss">Duration: <input class="form-control svelte-1qw7jss" type="number" min="1" max="50"></label></div> <!> <button class="btn btn-primary mt-4 svelte-1qw7jss">Start</button></div>'),Tt=k('<div class="center-hz svelte-1qw7jss"><div class="center-vt svelte-1qw7jss"><div class="center-hz svelte-1qw7jss"></div> <div class="center-hz svelte-1qw7jss"><!></div></div></div>');function pt(a,e){ne(e,!0);let r=G(e,"taskName",15,void 0),o=G(e,"onFinish",3,void 0),n=G(e,"onTaskFinish",3,void 0),s=p(!1),l=p(!1),f=p(O(e.mode.length)),u=z(()=>t(f)*60),i=p(O(new Date)),g=p(void 0),_=p(0),w=p(0),q=z(()=>t(_)+t(w)),y=z(()=>t(u)-t(q)),V=z(()=>Math.floor(Math.abs(t(y))/60)%60),I=z(()=>Math.round(Math.abs(t(y)))%60),E=z(()=>new Date(t(i).getTime()+(t(u)-t(w))*1e3)),j=z(()=>Math.min(100,Math.round(t(q)/t(u)*100))),F=[10,5,2,1,0];for(;F[0]>=e.mode.length;)F=F.slice(1);function K(h,S,x="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let A={body:S,img:""};x!=null&&(A.tag=x),new Notification(h,A)}}function D(){d(_,(new Date-t(i))/1e3),t(y)<F[0]*60&&(t(y)<0&&F[0]==0?K("Pomodoro","Finished. Good job!"):K("Pomodoro",`${(t(y)/60).toFixed(2)} minutes remaining.`),F=F.slice(1))}function W(){Notification.requestPermission().then(h=>{}),d(s,!0),d(l,!1),t(_)!=0&&(d(w,t(w)+t(_)),d(_,0)),d(i,O(new Date)),D(),d(g,O(setInterval(D,1e3)))}function L(h=!1,S=!1){let x=t(q)/60;o()(x,h?0:e.mode.calcScore(x,t(f)),S),d(s,!1),d(l,!1),clearInterval(t(g)),d(_,0),d(w,0)}function $(){d(l,!0),clearInterval(t(g))}ot(()=>{t(s)&&L(!1,!1)});function ee(){n()(r()),document.getElementById("timer-name-edit").select()}var Q=Tt();tt("keydown",Ye,h=>{h.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),t(s)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&(h.key==" "?(t(l)?W():$(),h.preventDefault()):h.key=="f"&&r()!=null&&confirm("Finish task: "+r())&&(ee(),h.preventDefault()))}),at(h=>{P((S,x)=>$e.title=`${S??""}:${x??""} - Pomodoro`,[()=>t(V).toString().padStart(2,"0"),()=>t(I).toString().padStart(2,"0")])});var ge=c(Q),we=m(c(ge),2),Ne=c(we);{var Pe=h=>{var S=jt(),x=c(S);dt(x,{get progress(){return t(j)},get color(){return e.mode.color},children:(T,M)=>{var ce=bt(),de=c(ce),Le=c(de,!0);v(de);var se=m(de,2),Ae=c(se);v(se);var qe=m(se,2),ye=c(qe),Ce=c(ye);{var Be=B=>{var N=_t();nt(N),P(()=>J(N,"placeholder",e.mode.name)),fe(N,r),b(B,N)},Oe=B=>{var N=ht(),ue=c(N,!0);v(N),P(()=>H(ue,e.mode.name)),b(B,N)};U(Ce,B=>{e.mode.hasTask?B(Be):B(Oe,!1)})}v(ye),v(qe),v(ce),P((B,N,ue)=>{H(Le,B),Y(se,"paused",t(l)),H(Ae,`${N??""}:${ue??""}`)},[()=>t(E).toLocaleTimeString(),()=>t(V).toString().padStart(2,"0"),()=>t(I).toString().padStart(2,"0")]),b(T,ce)},$$slots:{default:!0}});var A=m(x,2),R=c(A);R.__click=[kt,L];var te=m(c(R));const ie=z(()=>e.mode.calcScore(t(q)/60,t(f)));var ve=z(()=>t(ie));Fe(te,{get amount(){return t(ve)}}),v(R);var C=m(R,2);{var X=T=>{var M=gt();M.__click=ee,b(T,M)};U(C,T=>{e.mode.hasTask&&T(X)})}var Z=m(C,2);Z.__click=[wt,L];var ae=m(Z,2);{var Me=T=>{var M=qt();M.__click=W,b(T,M)},ze=T=>{var M=yt();M.__click=$,b(T,M)};U(ae,T=>{t(l)?T(Me):T(ze,!1)})}v(A),v(S),b(h,S)},De=h=>{var S=St(),x=c(S),A=c(x),R=m(c(A));ke(R),v(A),v(x);var te=m(x,2);{var ie=C=>{var X=xt(),Z=c(X),ae=m(c(Z));ke(ae),v(Z),v(X),fe(ae,r),b(C,X)};U(te,C=>{e.mode.hasTask&&C(ie)})}var ve=m(te,2);ve.__click=W,v(S),fe(R,()=>t(f),C=>d(f,C)),b(h,S)};U(Ne,h=>{t(s)?h(Pe):h(De,!1)})}v(we),v(ge),v(Q),P(()=>{Y(Q,"overDone",t(y)<0),Y(Q,"almostDone",t(y)<60)}),b(a,Q),oe()}et(["click"]);class be{constructor({name:e,length:r,color:o,reward:n,hasTask:s=!1}){this.name=e,this.length=r,this.color=o,this.reward=n,this.hasTask=s}calcScore(e,r){let o=5;if(e<.1)return 0;let n=e>r?Math.min(1,r/this.length):e<this.length?e/this.length:1,s=e>r?Math.pow((e-r)/o,2):0;return Math.max(0,Math.round((n-s)*this.reward))}}var It=k('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-1w7m3ok"> </label>',1),Et=k('<br> <br>  <div class="menu-bar mb-3 svelte-1w7m3ok"><div></div> <div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> <!></div> <!>',1);function Rt(a,e){ne(e,!0);const r=[],o={work:new be({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new be({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new be({name:"Long Break",length:10,color:"#237047",reward:450})};let n=p(""),s=p("work"),l=0;function f(I,E){{let j=parseInt(localStorage.getItem("points"));j&&(E=parseInt(j))}return E}let u=p(O(f("points",0)));pe(()=>{localStorage.setItem("points",t(u))});function i(I,E,j){d(u,t(u)+E),j&&(t(s)=="work"?(l+=I,l>=o.work.length*3.4?(l=0,d(s,"longbreak")):d(s,"break")):d(s,"work"))}function g(){d(u,t(u)+1e3)}var _=Et(),w=m(le(_),4),q=m(c(w),2);st(q,21,()=>Object.entries(o),rt,(I,E)=>{let j=()=>t(E)[0],F=()=>t(E)[1];var K=It(),D=le(K);ke(D);var W,L=m(D,2),$=c(L,!0);v(L),P(()=>{J(D,"id",`radio-${j()}`),W!==(W=j())&&(D.value=(D.__value=j())==null?"":j()),J(L,"for",`radio-${j()}`),J(L,"style",t(s)==j()?`background-color: ${F().color};`:""),H($,F().name)}),vt(r,[],D,()=>(j(),t(s)),ee=>d(s,ee)),b(I,K)}),v(q);var y=m(q,2);Fe(y,{get amount(){return t(u)}}),v(w);var V=m(w,2);Ee(V,()=>t(s),I=>{pt(I,{get mode(){return o[t(s)]},onFinish:i,onTaskFinish:g,get taskName(){return t(n)},set taskName(E){d(n,O(E))}})}),b(a,_),oe()}export{Rt as component};
