import{a as b,t as g,c as De}from"../chunks/H6rz9AAG.js";import{v as Ee,aJ as ze,aK as Me,y as Fe,w as ce,K as Pe,R as Ne,z as Le,C as Ae,af as Be,p as $,c as v,r as l,t as B,a as ee,f as ie,ah as z,h as ve,s as _,g as e,ad as d,$ as qe,m as F,aL as de,aI as ue}from"../chunks/BiMIkRpw.js";import{s as Y,d as me,e as fe,h as Oe}from"../chunks/Cb2Y7ODg.js";import{e as he,i as be}from"../chunks/BB9lrHUQ.js";import{s as q,r as ne}from"../chunks/U89Qky7J.js";import{a as _e,b as Ce,c as Je}from"../chunks/Bom5U9kS.js";import{p as P}from"../chunks/BpNZxsh_.js";import{p as G,i as V}from"../chunks/BCJTda2b.js";import{t as W}from"../chunks/CPYilYw2.js";import{a as Re}from"../chunks/C3_Mm2TB.js";import{s as Ue}from"../chunks/CX6vcbmV.js";function ge(p,t,c){ce&&Pe();var n=p,a=Be,r,S=Ee()?ze:Me;Fe(()=>{S(a,a=t())&&(r&&Ne(r),r=Le(()=>c(n)))}),ce&&(n=Ae)}var Ke=g('<div><div class="backing svelte-efxvsm"><div><!></div></div></div>');function Ge(p,t){$(t,!0);let c=G(t,"borderRadius",3,"10px"),n=G(t,"progress",7,0),a=G(t,"color",3,"rgb(153, 86, 86)"),r=G(t,"extraPadding",3,"18px"),S=G(t,"style",3,"");n(Math.max(1,n()));var m=Ke(),k=v(m),y=v(k),w=v(y);{var I=i=>{var s=De(),f=ie(s);Ue(f,()=>t.children),b(i,s)};V(w,i=>{t.children&&i(I)})}l(y),l(k),l(m),B(()=>{q(m,"style",`aspect-ratio: 1/1; display: inline-block; ${S()??""}`),q(k,"style",`--ring-width: ${c()??""}; --progress: ${n()??""}%; --ring-color: ${a()??""}; --extra-padding: ${r()??""};`)}),b(p,m),ee()}var Qe=g('<span class="points-change svelte-15n4znc"> </span>'),Ve=g('<!> <span class="points svelte-15n4znc"> </span>',1),We=g('<span class="point-view svelte-15n4znc">ðŸª™ <!></span>');function ye(p,t){$(t,!0);let c=t.amount==null,n=z(0),a=z(P(t.amount));ve(()=>{t.amount!=e(a)&&(d(n,t.amount-e(a)),d(a,P(t.amount)))});var r=We(),S=_(v(r));ge(S,()=>t.amount,m=>{var k=Ve(),y=ie(k);{var w=s=>{var f=Qe(),h=v(f);l(f),B(T=>{q(f,"style",`color: ${(e(n)>=0?"#0F0":"#F00")??""};`),Y(h,`${(e(n)>0?"+":"-")??""}${T??""}`)},[()=>Math.abs(e(n))]),b(s,f)};V(y,s=>{e(n)!=0&&s(w)})}var I=_(y,2),i=v(I,!0);l(I),B(()=>Y(i,t.amount)),b(m,k)}),l(r),B(()=>{W(r,"hide-first",c),W(r,"hide-first-reveal",t.amount!=null&&c)}),b(p,r),ee()}var Xe=(p,t)=>confirm("Quit timer without cashing out?")?t(!0,!1):null,Ze=g('<button class="btn btn-danger svelte-vyjiyu" aria-label="resume"><i class="bi bi-play-fill svelte-vyjiyu"></i></button>'),He=g('<button class="btn btn-outline svelte-vyjiyu" aria-label="pause"><i class="bi bi-pause-fill svelte-vyjiyu"></i></button>'),Ye=g('<div class="center-hz svelte-vyjiyu"><button class="btn btn-outline svelte-vyjiyu" aria-label="quit timer without cashing out points"><i class="bi bi-x-circle svelte-vyjiyu"></i></button> <!></div>'),$e=g('<div class="center-hz svelte-vyjiyu"><input class="form-control svelte-vyjiyu" type="number" style="width: 50%;" min="1" max="50"></div>'),et=g('<div class="svelte-vyjiyu"><div class="center-hz svelte-vyjiyu" style="color: #bbbE;"> </div> <div class="timer-text center-hz svelte-vyjiyu"> </div> <!></div>'),tt=(p,t)=>t(!1,!0),at=g('<button id="cashout-btn" class="btn btn-secondary btn-lg svelte-vyjiyu">Cash Out <!></button>'),it=g('<button class="btn btn-primary btn-lg svelte-vyjiyu">Start</button>'),nt=g('<div class="center-hz svelte-vyjiyu"><div class="center-vt svelte-vyjiyu" style="width: 100%;"><div class="appear svelte-vyjiyu"><!> <div class="center-hz mt-4 svelte-vyjiyu"><!></div></div></div></div>');function rt(p,t){$(t,!0);let c=G(t,"onFinish",3,void 0),n=z(!1),a=z(!1),r=z(P(t.mode.length)),S=F(()=>e(r)*60),m=z(P(new Date)),k=z(void 0),y=z(0),w=z(0),I=F(()=>e(y)+e(w)),i=F(()=>e(S)-e(I)),s=F(()=>Math.floor(Math.abs(e(i))/60)%60),f=F(()=>Math.round(Math.abs(e(i)))%60),h=F(()=>`${e(s).toString().padStart(2,"0")}:${e(f).toString().padStart(2,"0")}`),T=F(()=>new Date(e(m).getTime()+(e(S)-e(w))*1e3)),N=F(()=>Math.min(100,Math.round(e(I)/e(S)*100))),x=[10,5,2,1,0];for(;x[0]>=t.mode.length;)x=x.slice(1);function R(u,E,M="pomodoroUpdate"){if((Notification==null?void 0:Notification.permission)==="granted"){let C={body:E,img:""};M!=null&&(C.tag=M),new Notification(u,C)}}function D(){d(y,(new Date-e(m))/1e3),e(i)<x[0]*60?(e(i)<0&&x[0]==0?R("Pomodoro","Finished. Good job!"):R("Pomodoro",`${x[0]} minutes remaining.`),x=x.slice(1)):e(i)<0&&x.length==0&&Math.abs(Math.abs(e(i))%60-30)<.6&&R("Pomodoro",`Overtime by ${(Math.abs(e(i))%60).toFixed(1)} minutes.`)}function j(){Notification.requestPermission().then(u=>{}),d(n,!0),d(a,!1),e(y)!=0&&(d(w,e(w)+e(y)),d(y,0)),d(m,P(new Date)),D(),d(k,P(setInterval(D,1e3)))}function o(u=!1,E=!1){let M=e(I)/60;c()(M,u?0:t.mode.calcScore(M,e(r)),E),d(n,!1),d(a,!1),clearInterval(e(k)),d(y,0),d(w,0)}function L(){d(a,!0),clearInterval(e(k))}Re(()=>{e(n)&&o(!1,!1)});var O=nt();fe("keydown",de,u=>{u.key=="Escape"&&document.activeElement==document.getElementById("timer-name-edit")&&document.activeElement.blur(),e(n)&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)&&u.key==" "&&(e(a)?j():L(),u.preventDefault())}),fe("beforeunload",de,u=>{e(n)&&(u.preventDefault(),u.returnValue=!0)}),Oe(u=>{B(()=>qe.title=`${(e(n)?`${e(h)} - `:"")??""}pomodoro`)});var A=v(O),X=v(A),U=v(X);Ge(U,{get progress(){return e(N)},get color(){return t.mode.color},style:"width: 100%;",children:(u,E)=>{var M=et(),C=v(M),se=v(C,!0);l(C);var ae=_(C,2),je=v(ae,!0);l(ae);var we=_(ae,2);{var Ie=J=>{var K=Ye(),Z=v(K);Z.__click=[Xe,o];var oe=_(Z,2);{var Te=Q=>{var H=Ze();H.__click=j,b(Q,H)},xe=Q=>{var H=He();H.__click=L,b(Q,H)};V(oe,Q=>{e(a)?Q(Te):Q(xe,!1)})}l(K),b(J,K)},Se=J=>{var K=$e(),Z=v(K);ne(Z),l(K),_e(Z,()=>e(r),oe=>d(r,oe)),b(J,K)};V(we,J=>{e(n)?J(Ie):J(Se,!1)})}l(M),B(J=>{Y(se,J),W(ae,"paused",e(a)),Y(je,e(h))},[()=>e(T).toLocaleTimeString()]),b(u,M)},$$slots:{default:!0}});var te=_(U,2),re=v(te);{var pe=u=>{var E=at();E.__click=[tt,o];var M=_(v(E));const C=F(()=>t.mode.calcScore(e(I)/60,e(r)));var se=F(()=>e(C));ye(M,{get amount(){return e(se)}}),l(E),b(u,E)},ke=u=>{var E=it();E.__click=j,b(u,E)};V(re,u=>{e(n)?u(pe):u(ke,!1)})}l(te),l(X),l(A),l(O),B(()=>{W(O,"overDone",e(i)<0),W(O,"almostDone",e(i)<60)}),b(p,O),ee()}me(["click"]);var st=(p,t,c)=>t()!=null?t()(e(c).finished):null,ot=g('<i class="bi bi-check-square-fill svelte-1jf04s4"></i>'),lt=g('<i class="bi bi-check-square svelte-1jf04s4"></i>'),vt=g('<div class="center-hz todo-item svelte-1jf04s4"><input type="checkbox" class="btn-check svelte-1jf04s4" autocomplete="off"> <label class="btn btn-outline svelte-1jf04s4" style="border: none;"><!></label> <input class="todo-name svelte-1jf04s4" aria-label="Todo name"></div>'),ct=(p,t,c)=>{t(e(c).length-1)},dt=g('<div class="center-vt todo-list svelte-1jf04s4"><h3 style="color: white; margin: 0px;" class="svelte-1jf04s4">Task List</h3> <!> <div class="center-hz todo-item mt-3 svelte-1jf04s4"><button class="btn btn-secondary svelte-1jf04s4">Add Task</button></div></div>');function ut(p,t){$(t,!0);let c=G(t,"onFinish",3,void 0);function n(i,s,f=null){{let h=localStorage.getItem(i);h&&(s=JSON.parse(h))}return s}let a=z(P(n("todos",[{name:"",finished:!1}])));ve(()=>{localStorage.setItem("todos",JSON.stringify(e(a)))});function r(i){return`todo-item-${Math.min(Math.max(0,i),e(a).length-1)}-input`}function S(i){d(a,P([...e(a).slice(0,i+1),{id:Date.now(),name:"",finished:!1},...e(a).slice(i+1)])),ue().then(()=>{document.getElementById(r(i+1)).focus()})}function m(i,s){var f,h;console.log(i.key),i.key=="Enter"&&e(a)[s].name!=""?(i.preventDefault(),S(s)):(i.key=="Backspace"||i.key=="Delete")&&e(a)[s].name==""&&e(a).length>1?(i.preventDefault(),d(a,P([...e(a).slice(0,s),...e(a).slice(s+1)])),ue().then(()=>{var T;(T=document.getElementById(r(s-1)))==null||T.focus()})):i.key=="ArrowUp"?(f=document.getElementById(r(s-1)))==null||f.focus():i.key=="ArrowDown"&&((h=document.getElementById(r(s+1)))==null||h.focus())}var k=dt(),y=_(v(k),2);he(y,17,()=>e(a),be,(i,s,f)=>{var h=vt(),T=v(h);ne(T),q(T,"id",`todo-btn-${f??""}`),T.__change=[st,c,s];var N=_(T,2);q(N,"for",`todo-btn-${f??""}`);var x=v(N);{var R=o=>{var L=ot();b(o,L)},D=o=>{var L=lt();b(o,L)};V(x,o=>{e(s).finished?o(R):o(D,!1)})}l(N);var j=_(N,2);ne(j),q(j,"id",`todo-item-${f}-input`),j.__keydown=o=>m(o,f),l(h),B(()=>W(h,"finished",e(s).finished)),Ce(T,()=>e(s).finished,o=>e(s).finished=o),_e(j,()=>e(s).name,o=>e(s).name=o),b(i,h)});var w=_(y,2),I=v(w);I.__click=[ct,S,a],l(w),l(k),b(p,k),ee()}me(["change","keydown","click"]);class le{constructor({name:t,length:c,color:n,reward:a,hasTask:r=!1}){this.name=t,this.length=c,this.color=n,this.reward=a,this.hasTask=r}calcScore(t,c){let n=5;if(t<.5)return 0;let a=t>c?Math.min(1,c/this.length):t<this.length?t/this.length:1,r=t>c?Math.pow((t-c)/n,2):0;return Math.max(0,Math.round((a-r)*this.reward))}}var ft=g('<input type="radio" class="btn-check" autocomplete="off"> <label class="btn btn-outline radio-btn svelte-jjju7w"> </label>',1),mt=g('<br> <br>  <div class="menu-bar mb-3 svelte-jjju7w"><div></div> <div class="btn-group" role="group" aria-label="Pomodoro Mode Selector"></div> <!></div> <div class="blocky-container mt-5 svelte-jjju7w"><div class="svelte-jjju7w"></div> <div style="margin-bottom: 70px;" class="svelte-jjju7w"><!></div> <div class="center-hz svelte-jjju7w"><div><!></div></div></div>',1);function Tt(p,t){$(t,!0);const c=[],n={work:new le({name:"Work",length:25,color:"#ab5744",reward:1e3,hasTask:!0}),break:new le({name:"Break",length:5,color:"#4d82ab",reward:300}),longbreak:new le({name:"Long Break",length:10,color:"#237047",reward:450})};let a=z("work"),r=0;function S(D,j){{let o=parseInt(localStorage.getItem("points"));o&&(j=parseInt(o))}return j}let m=z(P(S("points",0)));ve(()=>{localStorage.setItem("points",e(m))});function k(D,j,o){d(m,e(m)+j),o&&(e(a)=="work"?(r+=D,r>=n.work.length*3.4?(r=0,d(a,"longbreak")):d(a,"break")):d(a,"work"))}function y(D){d(m,e(m)+200*(D?1:-1))}var w=mt(),I=_(ie(w),4),i=_(v(I),2);he(i,21,()=>Object.entries(n),be,(D,j)=>{let o=()=>e(j)[0],L=()=>e(j)[1];var O=ft(),A=ie(O);ne(A);var X,U=_(A,2),te=v(U,!0);l(U),B(()=>{q(A,"id",`radio-${o()}`),X!==(X=o())&&(A.value=(A.__value=o())==null?"":o()),q(U,"for",`radio-${o()}`),q(U,"style",e(a)==o()?`background-color: ${L().color};`:""),Y(te,L().name)}),Je(c,[],A,()=>(o(),e(a)),re=>d(a,re)),b(D,O)}),l(i);var s=_(i,2);ye(s,{get amount(){return e(m)}}),l(I);var f=_(I,2),h=_(v(f),2),T=v(h);ge(T,()=>e(a),D=>{rt(D,{get mode(){return n[e(a)]},onFinish:k})}),l(h);var N=_(h,2),x=v(N),R=v(x);ut(R,{onFinish:y}),l(x),l(N),l(f),b(p,w),ee()}export{Tt as component};
